<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<!-- ===== XRBitcoinCash · SEO/AI Meta Pack v1 (diagnostics · health) ===== -->
<link rel="canonical" href="https://xrbitcoincash.com/ai/ai/health.html" />
<link rel="alternate" hreflang="en" href="https://xrbitcoincash.com/ai/ai/health.html" />

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#0b0f14" />
<!-- Diagnostics pages: do not index, but allow following links -->
<meta name="robots" content="noindex,follow,max-image-preview:large" />
<meta name="description" content="XRBitcoinCash (XRBC) diagnostics: server health, ledger freshness, and connectivity checks for transparency and troubleshooting." />

<!-- Open Graph -->
<meta property="og:type" content="website" />
<meta property="og:site_name" content="XRBitcoinCash" />
<meta property="og:title" content="XRBC Diagnostics · Health" />
<meta property="og:description" content="Server health, ledger freshness, and connectivity checks for XRBitcoinCash (XRBC)." />
<meta property="og:url" content="https://xrbitcoincash.com/ai/ai/health.html" />
<meta property="og:image" content="https://xrbitcoincash.com/xrbc-nft.png" />
<meta property="og:locale" content="en_US" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="XRBC Diagnostics · Health" />
<meta name="twitter:description" content="Server health, ledger freshness, and connectivity checks for XRBitcoinCash (XRBC)." />
<meta name="twitter:image" content="https://xrbitcoincash.com/xrbc-nft.png" />

<!-- Icons -->
<link rel="icon" href="/xrbc-nft.png" sizes="any" />
<link rel="apple-touch-icon" href="/xrbc-nft.png" />

<!-- JSON-LD: WebPage (diagnostics) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "XRBC Diagnostics · Health",
  "url": "https://xrbitcoincash.com/ai/ai/health.html",
  "description": "Diagnostics for XRBitcoinCash (XRBC): server health, ledger freshness, and connectivity checks.",
  "image": "https://xrbitcoincash.com/xrbc-nft.png",
  "isPartOf": {
    "@type": "WebSite",
    "name": "XRBitcoinCash",
    "url": "https://xrbitcoincash.com/"
  }
}
</script>
<!-- ===== End Meta Pack v1 (diagnostics · health) ===== -->

  <title>XRBC health</title>
<pre id="out">{"status":"initializing"}</pre>
<script>
(function(){
  const out = document.getElementById('out');
  const now = () => new Date().toISOString();
  const cfg = {
    proxy:"https://xrbitcoincash-github-io.onrender.com",
    ua:"/universal-ai.json",
    toml:"/.well-known/xrp-ledger.toml"
  };

  function write(obj){ try{ out.textContent = JSON.stringify(obj, null, 2); }catch(_){ out.textContent = String(obj); } }

  async function callXRPL(payload){
    const r = await fetch(cfg.proxy, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    if(!r.ok) throw new Error("proxy HTTP "+r.status);
    const j = await r.json();
    if (j.error) throw new Error("xrpl "+JSON.stringify(j.error));
    return j;
  }
  async function getText(u){ const r=await fetch(u,{cache:"no-store"}); if(!r.ok) throw new Error(u+" HTTP "+r.status); return r.text(); }
  async function getJSON(u){ const r=await fetch(u,{cache:"no-store"}); if(!r.ok) throw new Error(u+" HTTP "+r.status); return r.json(); }

  // show that JS is running
  write({status:"running", updated_at: now()});

  window.addEventListener('DOMContentLoaded', async () => {
    try{
      const [stateP, uaP, tomlP] = await Promise.allSettled([
        callXRPL({method:"server_state",params:[]}),
        getJSON(cfg.ua),
        getText(cfg.toml)
      ]);

      const s = stateP.status==="fulfilled" ? (stateP.value.result?.state || {}) : null;
      const v = s?.validated_ledger || {};
      const peers = s?.peers ?? null;
      const server_state = s?.server_state ?? null;
      const hasValidated = typeof v?.seq === "number" || typeof v?.base_fee_xrp === "number";
      const ok = (server_state==="full" && (peers||0) >= 20) || hasValidated;

      write({
        project:"XRBitcoinCash",
        ok,
        server_state,
        peers,
        validated_seq: v?.seq ?? null,
        manifest_ok: uaP.status==="fulfilled",
        toml_ok: tomlP.status==="fulfilled",
        updated_at: now()
      });
    }catch(e){
      write({ ok:false, error:String(e.message||e), updated_at: now() });
      console.error(e);
    }
  });
})();
</script>
</html>
