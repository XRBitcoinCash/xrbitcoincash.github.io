<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <!--
    XRBitcoinCash Community Hub - Robust Dynamic Members Page
    Part: Full single-file SPA (HTML + CSS + JS)
    Features:
      - Real-time style chat (simulated socket & extensible transport)
      - Token trading embed (XPMarket iframe placeholder)
      - Price ticker (mock with extensibility for XRPL)
      - NFT gallery with filters, tags, lightbox modal
      - Trustline setup with XUMM deeplink and QR placeholder
      - Member profiles with reputation, badges, avatar, activity timeline
      - Governance proposals & voting (local signed-intent placeholder)
      - Airdrop eligibility & claim flow (mock)
      - Settings: theme, a11y, reduced motion, data persistence
      - Hash router and modular components
      - Responsive layout and accessible controls
    Notes:
      - Replace placeholder issuer, endpoints, and wallet integration per backend
      - This file is intentionally verbose to surface structure and future hooks
  -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>XRBitcoinCash Members · Community Hub</title>
  <meta name="description" content="Join the XRBitcoinCash community: live chat, trading tools, NFT gallery, trustline setup, governance, and airdrop participation." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://xrbitcoincash.com/members" />
  <meta property="og:title" content="XRBitcoinCash Members · Community Hub" />
  <meta property="og:description" content="Live chat, token tools, NFT gallery, trustlines, governance votes, and airdrops for XRBC." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='630'%3E%3Crect width='100%25' height='100%25' fill='%230b1118'/%3E%3Ctext x='50%25' y='50%25' fill='%23a7ff83' font-family='Segoe UI,Arial' font-size='64' text-anchor='middle' dominant-baseline='middle'%3EXRBitcoinCash Members%3C/text%3E%3C/svg%3E" />
  <meta name="theme-color" content="#0b1118" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3CradialGradient id='g' cx='50%25' cy='50%25' r='50%25'%3E%3Cstop offset='0%25' stop-color='%235af7ff'/%3E%3Cstop offset='100%25' stop-color='%230b1118'/%3E%3C/radialGradient%3E%3C/defs%3E%3Ccircle cx='32' cy='32' r='32' fill='url(%23g)'/%3E%3Cpath d='M16 32h32M22 22h20M22 42h20' stroke='%23a7ff83' stroke-width='3' stroke-linecap='round'/%3E%3C/svg%3E" />

  <style>
    /* ========== CSS RESET & ROOT ==========
       Keep spacing readable; large stylesheet supports extensibility. */

    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Inter, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(90,247,255,0.06), transparent),
        radial-gradient(900px 500px at 90% -10%, rgba(167,255,131,0.06), transparent),
        var(--bg);
      color: var(--text);
    }
    img, picture, video, canvas, svg { display: block; max-width: 100%; }
    input, button, textarea, select { font: inherit; }
    a { color: var(--accent); text-decoration: none; }

    :root {
      --bg: #0b1118;
      --bg-soft: #101824;
      --panel: #0f1722;
      --panel-2: #121c2a;
      --text: #e7eef8;
      --muted: #9bb1c9;
      --brand: #a7ff83;
      --brand-2: #e3ff5a;
      --accent: #5af7ff;
      --ok: #31d0aa;
      --warn: #f7b500;
      --danger: #ff6b6b;
      --ring: 0 0 0 2px rgba(167,255,131,0.28);
      --shadow: 0 16px 60px rgba(0,0,0,0.35);
      --radius-xl: 18px;
      --radius: 14px;
      --radius-sm: 10px;
      --radius-xs: 8px;
      --grid-gap: 16px;
    }

    [data-theme="light"] {
      --bg: #f5f7fb;
      --bg-soft: #edf2f8;
      --panel: #ffffff;
      --panel-2: #f7fbff;
      --text: #0e1726;
      --muted: #5a6b7e;
      --brand: #2ea043;
      --brand-2: #56d364;
      --accent: #005fcc;
      --shadow: 0 16px 50px rgba(12, 28, 50, 0.12);
      --ring: 0 0 0 2px rgba(0,95,204,0.25);
    }

    [data-reduced-motion="true"] * {
      animation: none !important;
      transition: none !important;
    }

    /* ========== LAYOUT ========== */

    .app {
      display: grid;
      grid-template-rows: auto 1fr auto;
      min-height: 100dvh;
    }

    header.appbar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: linear-gradient(180deg, rgba(11,17,24,0.92), rgba(11,17,24,0.6));
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(167,255,131,0.15);
    }

    .wrap {
      max-width: 1240px;
      margin: 0 auto;
      padding: 14px 18px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      align-items: center;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand .logo {
      width: 40px; height: 40px; border-radius: 50%;
      box-shadow: 0 0 0 2px rgba(90,247,255,0.25);
      background: radial-gradient(32px 32px at 50% 50%, rgba(90,247,255,0.25), rgba(11,17,24,0.1));
      display: grid; place-items: center;
      overflow: hidden;
    }

    .brand .logo svg { width: 26px; height: 26px; }

    .brand .title {
      display: flex; flex-direction: column;
    }

    .brand .title h1 {
      margin: 0; font-size: 18px; letter-spacing: 0.4px; font-weight: 800;
    }

    .brand .title small {
      margin: 0; font-size: 12px; color: var(--muted);
    }

    nav.topnav {
      display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
    }

    .chip {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px;
      border-radius: 9999px;
      border: 1px solid rgba(90,247,255,0.18);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--text); font-weight: 600; font-size: 13px;
      transition: transform 0.12s ease, border-color 0.12s ease, background 0.12s ease, color 0.12s ease;
    }
    .chip:hover { transform: translateY(-1px); border-color: rgba(167,255,131,0.35); }

    .actions { display: flex; align-items: center; gap: 8px; }

    .btn {
      appearance: none;
      border: 1px solid rgba(167,255,131,0.25);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--text);
      font-weight: 700; letter-spacing: .2px;
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease, color .12s ease;
    }
    .btn:hover { transform: translateY(-1px); border-color: var(--brand); }
    .btn.brand {
      background: linear-gradient(180deg, rgba(167,255,131,0.14), rgba(90,247,255,0.10));
      border-color: rgba(90,247,255,0.25);
    }
    .btn.ghost { background: transparent; }
    .btn.danger { border-color: rgba(255,107,107,0.45); color: #ffdada; }

    main {
      padding: 18px;
    }

    .grid {
      display: grid; gap: var(--grid-gap);
    }

    .cols-3 { grid-template-columns: 2fr 1fr 1fr; }
    .cols-2 { grid-template-columns: 2fr 1fr; }
    .cols-1 { grid-template-columns: 1fr; }

    @media (max-width: 1140px) {
      .cols-3 { grid-template-columns: 1.5fr 1fr; }
    }
    @media (max-width: 920px) {
      .row { grid-template-columns: 1fr; }
      nav.topnav { order: 3; }
      .actions { order: 2; }
      .cols-3, .cols-2 { grid-template-columns: 1fr; }
    }

    /* ========== PANELS & UTIL ========== */

    .panel {
      border: 1px solid rgba(90,247,255,0.16);
      border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      box-shadow: var(--shadow);
      overflow: clip;
    }

    .panel .head {
      display: flex; align-items: center; justify-content: space-between; gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(167,255,131,0.12);
      background: linear-gradient(180deg, rgba(90,247,255,0.06), transparent);
    }

    .panel .head h3 {
      margin: 0; font-size: 16px; letter-spacing: .3px;
    }

    .panel .body { padding: 14px; }

    .toolbar { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }

    label { font-size: 12px; color: var(--muted); display: block; margin-bottom: 6px; }

    input[type="text"], input[type="search"], input[type="url"], input[type="number"], input[type="email"], textarea, select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(167,255,131,0.15);
      background: rgba(16,24,36,0.6);
      color: var(--text);
    }

    input::placeholder, textarea::placeholder { color: #6f86a3; }

    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* ========== HERO ========== */

    .hero {
      border: 1px solid rgba(90,247,255,0.16);
      border-radius: var(--radius-xl);
      background:
        radial-gradient(900px 500px at 0% -30%, rgba(90,247,255,0.08), transparent),
        radial-gradient(900px 500px at 100% -30%, rgba(167,255,131,0.08), transparent),
        linear-gradient(180deg, rgba(16,24,36,0.9), rgba(16,24,36,0.82));
      overflow: hidden;
    }

    .hero-inner {
      display: grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 20px;
      padding: 22px;
    }

    .badge {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 6px 10px;
      border-radius: 9999px;
      background: rgba(90,247,255,0.10);
      color: var(--accent);
      font-weight: 800; font-size: 12px;
      border: 1px solid rgba(90,247,255,0.2);
      letter-spacing: 0.3px;
    }

    .hero h2 { margin: 8px 0 4px; font-size: 28px; }
    .hero p { margin: 0; color: var(--muted); }

    .kpis {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px;
    }

    .kpi {
      padding: 14px;
      border-radius: 12px;
      border: 1px solid rgba(167,255,131,0.15);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
    }

    .kpi .label { color: var(--muted); font-size: 12px; }
    .kpi .value { font-family: var(--mono); font-size: 18px; margin-top: 4px; letter-spacing: .2px; }

    @media (max-width: 920px) {
      .hero-inner { grid-template-columns: 1fr; }
      .kpis { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 640px) {
      .kpis { grid-template-columns: 1fr; }
    }

    /* ========== CHAT ========== */

    .chat {
      display: grid;
      grid-template-rows: auto 1fr auto;
      height: 480px;
      gap: 10px;
    }

    .chat .history {
      border: 1px solid rgba(167,255,131,0.12);
      border-radius: 10px;
      background: #0e1624;
      padding: 10px;
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    .chat .msg {
      display: grid;
      grid-template-columns: 40px 1fr;
      gap: 10px;
      padding: 8px 6px;
      border-bottom: 1px dashed rgba(167,255,131,0.08);
    }

    .chat .msg:last-child { border-bottom: none; }

    .chat .avatar {
      width: 36px; height: 36px; border-radius: 50%;
      background: linear-gradient(180deg, rgba(167,255,131,0.25), rgba(90,247,255,0.2));
      border: 1px solid rgba(90,247,255,0.25);
      display: grid; place-items: center;
      color: #092017; font-weight: 900;
    }

    .chat .meta {
      display: flex; align-items: baseline; gap: 8px;
      font-size: 12px; color: var(--muted);
    }

    .chat .content { white-space: pre-wrap; word-break: break-word; }

    .chat .composer {
      display: grid; grid-template-columns: 1fr auto auto;
      gap: 8px;
    }

    .pill {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 6px 8px; border-radius: 9999px; font-size: 12px;
      border: 1px solid rgba(167,255,131,0.18);
      background: rgba(16,24,36,0.6);
      color: var(--muted);
    }

    .emoji-bar { display: flex; gap: 6px; flex-wrap: wrap; }

    /* ========== NFT GALLERY ========== */

    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 12px;
    }

    .card {
      border: 1px solid rgba(90,247,255,0.16);
      border-radius: 12px;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      overflow: hidden;
      display: grid;
    }

    .card .cap {
      padding: 10px;
      display: grid; gap: 6px;
    }

    .tag {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 4px 8px; border-radius: 9999px; font-size: 11px; font-weight: 700;
      border: 1px solid rgba(90,247,255,0.24);
      color: var(--accent);
      background: rgba(90,247,255,0.08);
    }

    .filters { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }

    .modal-backdrop {
      position: fixed; inset: 0; background: rgba(0,0,0,0.6);
      display: none; align-items: center; justify-content: center;
      z-index: 100;
    }

    .modal {
      width: min(92vw, 840px);
      border-radius: 14px;
      border: 1px solid rgba(90,247,255,0.25);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .modal .head, .modal .body, .modal .foot { padding: 14px; }
    .modal .head { display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(167,255,131,0.12); }
    .modal .foot { border-top: 1px solid rgba(167,255,131,0.12); display: flex; gap: 8px; justify-content: flex-end; }

    .modal-backdrop.active { display: flex; }

    /* ========== TRUSTLINE ========== */

    .trustline-grid {
      display: grid; grid-template-columns: 1.2fr 1fr; gap: 14px;
    }
    @media (max-width: 920px) { .trustline-grid { grid-template-columns: 1fr; } }

    .qr {
      width: 240px; height: 240px; border-radius: 8px;
      background: repeating-linear-gradient(45deg, #0e1624, #0e1624 6px, #0f1722 6px, #0f1722 12px);
      display: grid; place-items: center;
      color: var(--muted);
      border: 1px dashed rgba(167,255,131,0.25);
    }

    /* ========== PROFILES ========== */

    .profiles-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 12px;
    }

    .profile {
      display: grid; gap: 10px;
      border: 1px solid rgba(167,255,131,0.15);
      border-radius: 12px;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      padding: 12px;
    }

    .stars { color: #ffd76a; }

    .timeline {
      border-left: 2px dashed rgba(167,255,131,0.18);
      padding-left: 10px;
      display: grid; gap: 8px;
    }

    /* ========== GOVERNANCE ========== */

    .proposals { display: grid; gap: 10px; }
    .proposal {
      border: 1px solid rgba(90,247,255,0.16);
      border-radius: 12px;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      padding: 12px;
      display: grid; gap: 8px;
    }

    .progress {
      width: 100%; height: 10px; border-radius: 9999px;
      background: rgba(90,247,255,0.1);
      overflow: hidden;
      border: 1px solid rgba(90,247,255,0.18);
    }
    .progress .bar {
      height: 100%;
      background: linear-gradient(90deg, var(--brand), var(--accent));
      width: 0%;
      transition: width .3s ease;
    }

    /* ========== AIRDROPS ========== */

    .steps {
      display: grid; gap: 8px;
    }

    .step {
      border: 1px dashed rgba(167,255,131,0.28);
      border-radius: 10px;
      padding: 10px;
      background: rgba(16,24,36,0.5);
      display: grid; gap: 6px;
    }

    /* ========== FOOTER ========== */

    footer {
      border-top: 1px solid rgba(167,255,131,0.15);
      color: var(--muted);
      font-size: 12px;
      text-align: center;
      padding: 12px;
      background: linear-gradient(180deg, rgba(16,24,36,0.9), rgba(16,24,36,0.9));
    }

    /* ========== KEYFRAMES ========== */

    @keyframes pulseGlow {
      0% { box-shadow: 0 0 0 0 rgba(167,255,131,0.22); }
      70% { box-shadow: 0 0 0 12px rgba(167,255,131,0); }
      100% { box-shadow: 0 0 0 0 rgba(167,255,131,0); }
    }

    .glow { animation: pulseGlow 2.2s infinite; }

  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- ========== APP BAR ========== -->
    <header class="appbar">
      <div class="wrap">
        <div class="row">
          <div class="brand">
            <div class="logo" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="img" aria-label="XRBC logo">
                <circle cx="12" cy="12" r="10" fill="#0b1118"></circle>
                <path d="M6 12h12M8 8h8M8 16h8" stroke="#a7ff83" stroke-width="2" stroke-linecap="round"></path>
              </svg>
            </div>
            <div class="title">
              <h1>XRBitcoinCash Members</h1>
              <small class="mono">Live · Tools · Governance</small>
            </div>
          </div>
          <div class="actions">
            <nav class="topnav" aria-label="Primary">
              <a class="chip" href="#/home">Home</a>
              <a class="chip" href="#/chat">Chat</a>
              <a class="chip" href="#/trading">Trading</a>
              <a class="chip" href="#/nfts">NFTs</a>
              <a class="chip" href="#/trustline">Trustline</a>
              <a class="chip" href="#/profiles">Profiles</a>
              <a class="chip" href="#/governance">Governance</a>
              <a class="chip" href="#/airdrops">Airdrops</a>
              <a class="chip" href="#/settings">Settings</a>
            </nav>
            <button class="btn brand" id="btnConnect" aria-live="polite">Connect Wallet</button>
            <button class="btn ghost" id="btnTheme">Toggle Theme</button>
          </div>
        </div>
      </div>
    </header>

    <!-- ========== MAIN CONTENT ========== -->
    <main>
      <div class="wrap grid cols-1" id="routeHost">

        <!-- ========== HOME / HERO ========== -->
        <section class="hero" data-route="home">
          <div class="hero-inner">
            <div>
              <span class="badge">Community Hub</span>
              <h2>Build XRBitcoinCash together</h2>
              <p>Chat in real-time, manage trustlines, explore NFTs, and participate in governance and airdrops — all in one place.</p>
              <div class="kpis">
                <div class="kpi">
                  <div class="label">Members Online</div>
                  <div class="value" id="kpiOnline">—</div>
                </div>
                <div class="kpi">
                  <div class="label">XRBC Price</div>
                  <div class="value" id="kpiPrice">—</div>
                </div>
                <div class="kpi">
                  <div class="label">Active Proposals</div>
                  <div class="value" id="kpiProposals">—</div>
                </div>
              </div>
              <div style="margin-top:14px; display:flex; gap:8px; flex-wrap:wrap;">
                <a class="btn brand glow" href="#/chat">Join Chat</a>
                <a class="btn" href="#/trustline">Set Trustline</a>
                <a class="btn" href="#/governance">Vote Now</a>
              </div>
            </div>
            <div class="panel">
              <div class="head"><h3>Announcements</h3><div class="pill">RSS sync: on</div></div>
              <div class="body" id="announcements">
                <div class="step">
                  <strong>Welcome!</strong>
                  <div>Connect your XRPL wallet to unlock profile, voting, and airdrop tools.</div>
                </div>
                <div class="step">
                  <strong>XRBC Trading</strong>
                  <div>Access the XPMarket widget in Trading to check markets and depth.</div>
                </div>
                <div class="step">
                  <strong>Governance Cycle</strong>
                  <div>New proposals open every Friday 00:00 UTC. Snapshot on Sundays.</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== CHAT ========== -->
        <section class="panel" data-route="chat" hidden>
          <div class="head">
            <h3>Live Chat</h3>
            <div class="toolbar">
              <input type="search" id="chatSearch" placeholder="Search messages..." />
              <select id="chatFilterUser" title="Filter by user">
                <option value="">All users</option>
              </select>
              <div class="pill">Moderation: <span id="moderationState">off</span></div>
            </div>
          </div>
          <div class="body">
            <div class="chat" id="chat">
              <div class="history" id="chatHistory" aria-live="polite" aria-label="Chat history"></div>
              <div class="emoji-bar" id="emojiBar" aria-label="Reactions">
                <button class="btn" data-emoji="👍" title="Like">👍</button>
                <button class="btn" data-emoji="🔥" title="Fire">🔥</button>
                <button class="btn" data-emoji="💡" title="Idea">💡</button>
                <button class="btn" data-emoji="🎯" title="Target">🎯</button>
                <button class="btn" data-emoji="🚀" title="Rocket">🚀</button>
                <button class="btn" data-emoji="🤝" title="Handshake">🤝</button>
              </div>
              <div class="composer">
                <input id="chatInput" type="text" placeholder="Type a message. Use @username to mention, #tag to categorize." aria-label="Message input" />
                <button class="btn" id="btnAttach">Attach</button>
                <button class="btn brand" id="btnSend">Send</button>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== TRADING ========== -->
        <section class="panel" data-route="trading" hidden>
          <div class="head">
            <h3>XRBC Trading</h3>
            <div class="toolbar">
              <div class="pill">Network: XRPL Mainnet</div>
              <div class="pill">Latency: <span id="latency">—</span></div>
            </div>
          </div>
          <div class="body grid cols-2">
            <div>
              <label for="marketWidget">Market Widget</label>
              <iframe id="marketWidget" title="XPMarket - XRBC market" src="https://xpmarket.com/market/XRBC" style="width:100%;height:420px;border:none;border-radius:12px;"></iframe>
              <div class="step" style="margin-top:10px;">
                <strong>Ticker</strong>
                <div class="mono" id="ticker">XRBC/USD: — | 24h: —% | Vol: —</div>
              </div>
            </div>
            <div>
              <div class="card">
                <div class="cap">
                  <strong>Orderbook Depth (mock)</strong>
                  <div class="mono" id="orderbook">bids: — | asks: — | spread: —</div>
                </div>
              </div>
              <div class="card" style="margin-top:10px;">
                <div class="cap">
                  <strong>Recent Trades (mock)</strong>
                  <div id="trades" class="mono">—</div>
                </div>
              </div>
              <div class="card" style="margin-top:10px;">
                <div class="cap">
                  <strong>Alerts</strong>
                  <div class="toolbar">
                    <input type="number" id="alertPrice" placeholder="Price alert (USD)" />
                    <button class="btn" id="btnSetAlert">Set</button>
                    <div class="pill">Status: <span id="alertStatus">none</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== NFT GALLERY ========== -->
        <section class="panel" data-route="nfts" hidden>
          <div class="head">
            <h3>NFT Gallery</h3>
            <div class="toolbar">
              <input type="search" id="nftSearch" placeholder="Search NFTs by name or creator..." />
              <select id="nftFilterTag" title="Filter by tag">
                <option value="">All tags</option>
              </select>
              <button class="btn" id="btnMint">Mint (mock)</button>
            </div>
          </div>
          <div class="body">
            <div class="gallery" id="gallery"></div>
          </div>
        </section>

        <!-- ========== TRUSTLINE ========== -->
        <section class="panel" data-route="trustline" hidden>
          <div class="head">
            <h3>Set XRBC Trustline</h3>
            <div class="toolbar">
              <div class="pill">XRPL · Mainnet</div>
              <div class="pill">XRBC · Currency Code</div>
            </div>
          </div>
          <div class="body trustline-grid">
            <div>
              <div class="row" style="grid-template-columns: 1fr 1fr;">
                <div>
                  <label>Token code</label>
                  <input readonly value="XRBC" class="mono" />
                </div>
                <div>
                  <label>Issuer</label>
                  <input id="issuer" value="rEXAMPLEISSUERXRPLADDRESS000000000000000" class="mono" />
                </div>
              </div>
              <div class="row" style="grid-template-columns: 1fr 1fr; margin-top: 10px;">
                <div>
                  <label>Limit</label>
                  <input id="limit" type="number" value="1000000" />
                </div>
                <div>
                  <label>Flags</label>
                  <select id="flags">
                    <option value="tfSetAuth">tfSetAuth</option>
                    <option value="none" selected>none</option>
                  </select>
                </div>
              </div>
              <div class="toolbar" style="margin-top: 10px;">
                <button class="btn brand" id="btnXumm">Open in XUMM</button>
                <button class="btn" id="btnDeepLink">Copy deeplink</button>
                <button class="btn ghost" id="btnTestnet">Switch to Testnet</button>
              </div>
              <div class="step" style="margin-top: 10px;">
                <strong>Deeplink</strong>
                <div class="mono" id="deeplink">xumm://xapp?payload=trustset&issuer=…</div>
              </div>
              <div class="steps" style="margin-top: 12px;">
                <div class="step"><strong>1.</strong> Open your XRPL wallet (XUMM recommended).</div>
                <div class="step"><strong>2.</strong> Review token code (XRBC), issuer, and limit amount.</div>
                <div class="step"><strong>3.</strong> Sign the trustset transaction and wait for confirmation.</div>
              </div>
            </div>
            <div style="display:grid;place-items:center;">
              <div class="qr" id="qr">QR preview</div>
              <small class="muted" style="margin-top:8px; color: var(--muted);">Scan with XUMM to open payload.</small>
            </div>
          </div>
        </section>

        <!-- ========== PROFILES ========== -->
        <section class="panel" data-route="profiles" hidden>
          <div class="head">
            <h3>Member Profiles</h3>
            <div class="toolbar">
              <input type="search" id="profileSearch" placeholder="Search members..." />
              <select id="profileSort" title="Sort">
                <option value="reputation">Reputation</option>
                <option value="name">Name</option>
                <option value="joined">Joined</option>
              </select>
              <button class="btn" id="btnNewProfile">New Profile</button>
            </div>
          </div>
          <div class="body">
            <div class="profiles-grid" id="profiles"></div>
          </div>
        </section>

        <!-- ========== GOVERNANCE ========== -->
        <section class="panel" data-route="governance" hidden>
          <div class="head">
            <h3>Governance</h3>
            <div class="toolbar">
              <button class="btn" id="btnNewProposal">New Proposal</button>
              <div class="pill">Cycle: Weekly</div>
              <div class="pill">Snapshot: Sundays</div>
            </div>
          </div>
          <div class="body grid cols-2">
            <div>
              <label>Active Proposals</label>
              <div class="proposals" id="proposalList"></div>
            </div>
            <div>
              <label>Create / Review</label>
              <div class="proposal">
                <input id="propTitle" type="text" placeholder="Proposal title" />
                <textarea id="propBody" rows="6" placeholder="Details, rationale, success metrics..."></textarea>
                <div class="row" style="grid-template-columns: 1fr 1fr;">
                  <div><input id="optYes" type="text" placeholder="Option A (Yes)" value="Yes" /></div>
                  <div><input id="optNo" type="text" placeholder="Option B (No)" value="No" /></div>
                </div>
                <div class="toolbar">
                  <button class="btn brand" id="btnPublishProp">Publish</button>
                  <div class="pill">Hash: <span id="propHash" class="mono">—</span></div>
                </div>
              </div>
              <div class="proposal">
                <strong>Vote on Selected</strong>
                <div class="row" style="grid-template-columns: 1fr 1fr;">
                  <button class="btn" id="btnVoteA">Vote A</button>
                  <button class="btn" id="btnVoteB">Vote B</button>
                </div>
                <div class="progress" aria-label="Tally">
                  <div class="bar" id="barA"></div>
                </div>
                <div class="progress" style="margin-top:6px;">
                  <div class="bar" id="barB"></div>
                </div>
                <div class="mono" id="voteStatus" style="margin-top:6px;">—</div>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== AIRDROPS ========== -->
        <section class="panel" data-route="airdrops" hidden>
          <div class="head">
            <h3>Airdrops</h3>
            <div class="toolbar">
              <div class="pill">Eligibility: <span id="eligibility">unknown</span></div>
              <div class="pill">Snapshot: <span id="snapshotDate">—</span></div>
              <div class="pill">Status: <span id="airdropStatus">idle</span></div>
            </div>
          </div>
          <div class="body grid cols-2">
            <div>
              <div class="steps">
                <div class="step">
                  <strong>Requirements</strong>
                  <ul>
                    <li>Trustline set: XRBC / Issuer</li>
                    <li>Balance threshold met by snapshot</li>
                    <li>Unique wallet (anti-sybil checks)</li>
                  </ul>
                </div>
                <div class="step">
                  <strong>Check Eligibility</strong>
                  <div class="toolbar">
                    <input id="addrCheck" type="text" placeholder="XRPL address (r...)" class="mono" />
                    <button class="btn" id="btnCheck">Check</button>
                  </div>
                  <div class="mono" id="checkResult">—</div>
                </div>
                <div class="step">
                  <strong>Claim</strong>
                  <div class="toolbar">
                    <button class="btn brand" id="btnClaim">Claim Airdrop</button>
                    <button class="btn ghost" id="btnProof">Generate Proof (mock)</button>
                  </div>
                  <div class="mono" id="claimLog">—</div>
                </div>
              </div>
            </div>
            <div>
              <div class="card">
                <div class="cap">
                  <strong>Distribution Schedule</strong>
                  <ul>
                    <li>T1: 25% at claim</li>
                    <li>T2: 25% after 30 days</li>
                    <li>T3: 25% after 60 days</li>
                    <li>T4: 25% after 90 days</li>
                  </ul>
                </div>
              </div>
              <div class="card" style="margin-top:10px;">
                <div class="cap">
                  <strong>Notes</strong>
                  <p>For wallet safety, verify issuer and payload details before signing any transaction.</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ========== SETTINGS ========== -->
        <section class="panel" data-route="settings" hidden>
          <div class="head">
            <h3>Settings</h3>
            <div class="toolbar">
              <div class="pill">Persistence: local</div>
            </div>
          </div>
          <div class="body grid cols-2">
            <div class="card">
              <div class="cap">
                <strong>Theme</strong>
                <div class="toolbar">
                  <button class="btn" data-theme="dark">Dark</button>
                  <button class="btn" data-theme="light">Light</button>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="cap">
                <strong>Accessibility</strong>
                <div class="toolbar">
                  <label><input type="checkbox" id="reducedMotion" /> Reduced motion</label>
                  <label><input type="checkbox" id="highContrast" /> High contrast</label>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="cap">
                <strong>Data</strong>
                <div class="toolbar">
                  <button class="btn danger" id="btnReset">Reset Local Data</button>
                  <button class="btn" id="btnExport">Export</button>
                  <button class="btn" id="btnImport">Import</button>
                </div>
                <textarea id="dataBlob" rows="8" placeholder="Data JSON will appear here for export/import" class="mono"></textarea>
              </div>
            </div>
          </div>
        </section>

      </div>
    </main>

    <!-- ========== FOOTER ========== -->
    <footer>
      © 2025 XRBitcoinCash Community · XRPL tools provided as-is. Verify issuers and payloads before signing.
    </footer>
  </div>

  <!-- ========== MODAL HOSTS ========== -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="head">
        <strong id="modalTitle">Preview</strong>
        <button class="btn ghost" id="modalClose">Close</button>
      </div>
      <div class="body" id="modalBody">—</div>
      <div class="foot">
        <button class="btn" id="modalCancel">Cancel</button>
        <button class="btn brand" id="modalOk">OK</button>
      </div>
    </div>
  </div>

  <!-- ========== SCRIPTS ========== -->
  <script>
    // =========================================================
    // XRBitcoinCash Members SPA
    // Routing, State, Components, and Mock Integrations
    // =========================================================

    ;(function() {
      'use strict';

      // ---------- STATE ----------

      const state = {
        theme: (localStorage.getItem('theme') || 'dark'),
        reducedMotion: localStorage.getItem('reducedMotion') === 'true',
        highContrast: localStorage.getItem('highContrast') === 'true',
        wallet: {
          connected: false,
          address: '',
          network: 'xrpl-mainnet'
        },
        chat: {
          messages: [],
          users: new Set(),
          moderation: false
        },
        nfts: [],
        profiles: [],
        governance: {
          proposals: [],
          selected: null,
        },
        airdrops: {
          snapshot: '2025-09-01T00:00:00Z',
          eligibility: {},
          claims: []
        },
        metrics: {
          online: 0,
          price: null,
          activeProposals: 0
        },
        alerts: [],
      };

      // Preload some seed data for UX
      seed();

      // ---------- DOM HELPERS ----------

      const $ = sel => document.querySelector(sel);
      const $$ = sel => Array.from(document.querySelectorAll(sel));
      const routeHost = $('#routeHost');

      // ---------- ROUTER ----------

      const routes = new Map();
      $$('[data-route]').forEach(section => {
        routes.set(section.getAttribute('data-route'), section);
      });

      function navigate(hash) {
        const key = (hash || location.hash || '#/home').replace(/^#\//, '');
        routes.forEach((el, name) => {
          el.hidden = (name !== key);
        });
        // Focus first interactive element for a11y
        const visible = routes.get(key);
        if (visible) {
          const focusable = visible.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
          if (focusable) focusable.focus({ preventScroll: false });
        }
        onRoute(key);
      }

      window.addEventListener('hashchange', () => navigate());
      document.addEventListener('DOMContentLoaded', () => {
        applyTheme(state.theme);
        applyReducedMotion(state.reducedMotion);
        applyHighContrast(state.highContrast);
        bindGlobal();
        navigate();
        renderAll();
        startTickers();
      });

      // ---------- BINDINGS ----------

      function bindGlobal() {
        $('#btnTheme').addEventListener('click', toggleTheme);
        $('#btnConnect').addEventListener('click', connectWalletMock);

        // Modal bindings
        $('#modalClose').addEventListener('click', closeModal);
        $('#modalCancel').addEventListener('click', closeModal);
        $('#modalOk').addEventListener('click', () => { closeModal(); });

        // Chat
        $('#btnSend')?.addEventListener('click', sendMessage);
        $('#chatInput')?.addEventListener('keydown', e => {
          if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
        });
        $('#chatSearch')?.addEventListener('input', renderChat);
        $('#chatFilterUser')?.addEventListener('change', renderChat);
        $('#emojiBar')?.addEventListener('click', onEmoji);

        // Trading
        $('#btnSetAlert')?.addEventListener('click', setAlert);

        // NFTs
        $('#nftSearch')?.addEventListener('input', renderGallery);
        $('#nftFilterTag')?.addEventListener('change', renderGallery);
        $('#btnMint')?.addEventListener('click', mintMock);

        // Trustline
        $('#btnXumm')?.addEventListener('click', openXumm);
        $('#btnDeepLink')?.addEventListener('click', copyDeeplink);
        $('#btnTestnet')?.addEventListener('click', toggleTestnet);
        $('#issuer')?.addEventListener('input', updateDeeplink);
        $('#limit')?.addEventListener('input', updateDeeplink);
        $('#flags')?.addEventListener('change', updateDeeplink);

        // Profiles
        $('#profileSearch')?.addEventListener('input', renderProfiles);
        $('#profileSort')?.addEventListener('change', renderProfiles);
        $('#btnNewProfile')?.addEventListener('click', createProfile);

        // Governance
        $('#btnNewProposal')?.addEventListener('click', newProposalDraft);
        $('#btnPublishProp')?.addEventListener('click', publishProposal);
        $('#btnVoteA')?.addEventListener('click', () => castVote('A'));
        $('#btnVoteB')?.addEventListener('click', () => castVote('B'));

        // Airdrops
        $('#btnCheck')?.addEventListener('click', checkEligibility);
        $('#btnClaim')?.addEventListener('click', claimAirdrop);
        $('#btnProof')?.addEventListener('click', generateProof);

        // Settings
        $$('.card .cap [data-theme]').forEach(btn => {
          btn.addEventListener('click', () => applyTheme(btn.dataset.theme));
        });
        $('#reducedMotion')?.addEventListener('change', e => {
          state.reducedMotion = e.target.checked; localStorage.setItem('reducedMotion', String(state.reducedMotion)); applyReducedMotion(state.reducedMotion);
        });
        $('#highContrast')?.addEventListener('change', e => {
          state.highContrast = e.target.checked; localStorage.setItem('highContrast', String(state.highContrast)); applyHighContrast(state.highContrast);
        });
        $('#btnReset')?.addEventListener('click', resetLocal);
        $('#btnExport')?.addEventListener('click', exportData);
        $('#btnImport')?.addEventListener('click', importData);
      }

      // ---------- ROUTE-HOOKS ----------

      function onRoute(route) {
        switch (route) {
          case 'chat':
            renderChat();
            break;
          case 'trading':
            renderTrading();
            break;
          case 'nfts':
            renderGallery();
            break;
          case 'trustline':
            updateDeeplink();
            renderQR();
            break;
          case 'profiles':
            renderProfiles();
            break;
          case 'governance':
            renderProposals();
            break;
          case 'airdrops':
            renderAirdrops();
            break;
          case 'settings':
            syncSettingsUI();
            break;
          default:
            renderHome();
        }
      }

      // ---------- THEME / A11Y ----------

      function applyTheme(mode) {
        const root = document.documentElement;
        if (mode !== 'dark' && mode !== 'light') mode = 'dark';
        root.setAttribute('data-theme', mode);
        localStorage.setItem('theme', mode);
        state.theme = mode;
        $('#btnTheme').textContent = mode === 'dark' ? 'Light Mode' : 'Dark Mode';
      }

      function toggleTheme() {
        applyTheme(state.theme === 'dark' ? 'light' : 'dark');
      }

      function applyReducedMotion(on) {
        document.documentElement.setAttribute('data-reduced-motion', String(on));
      }

      function applyHighContrast(on) {
        document.body.style.filter = on ? 'contrast(1.15) saturate(1.05)' : 'none';
      }

      function syncSettingsUI() {
        $('#reducedMotion').checked = state.reducedMotion;
        $('#highContrast').checked = state.highContrast;
      }

      // ---------- HOME RENDER ----------

      function renderHome() {
        $('#kpiOnline').textContent = String(state.metrics.online);
        $('#kpiPrice').textContent = state.metrics.price ? ('$' + state.metrics.price.toFixed(5)) : '—';
        $('#kpiProposals').textContent = String(state.governance.proposals.length);
      }

      // ---------- CHAT LOGIC ----------

      function renderChat() {
        const history = $('#chatHistory');
        const term = ($('#chatSearch')?.value || '').toLowerCase();
        const userFilter = $('#chatFilterUser')?.value || '';
        const frag = document.createDocumentFragment();

        // Populate user filter options
        const sel = $('#chatFilterUser');
        if (sel && sel.options.length <= 1) {
          Array.from(state.chat.users).sort().forEach(u => {
            const opt = document.createElement('option');
            opt.value = u; opt.textContent = u;
            sel.append(opt);
          });
        }

        history.textContent = '';
        state.chat.messages
          .filter(m => (!term || m.text.toLowerCase().includes(term)) && (!userFilter || m.user === userFilter))
          .slice(-250) // cap
          .forEach(m => frag.appendChild(renderMsg(m)));
        history.appendChild(frag);
        history.scrollTop = history.scrollHeight;
        $('#moderationState').textContent = state.chat.moderation ? 'on' : 'off';
      }

      function renderMsg(m) {
        const el = document.createElement('div');
        el.className = 'msg';
        const av = document.createElement('div');
        av.className = 'avatar';
        av.textContent = m.user[0]?.toUpperCase() || '?';
        const body = document.createElement('div');
        const meta = document.createElement('div');
        meta.className = 'meta';
        const time = new Date(m.ts).toLocaleTimeString();
        meta.innerHTML = '<strong>' + escapeHtml(m.user) + '</strong><span>' + time + '</span><span class="tag">#' + escapeHtml(m.tag || 'general') + '</span>';
        const content = document.createElement('div');
        content.className = 'content';
        content.innerHTML = renderMarkdownInline(escapeHtml(m.text));
        body.append(meta, content);
        el.append(av, body);
        return el;
      }

      function onEmoji(e) {
        const emoji = e.target?.dataset?.emoji;
        if (!emoji) return;
        const input = $('#chatInput');
        input.value += ' ' + emoji;
        input.focus();
      }

      function sendMessage() {
        const input = $('#chatInput');
        const txt = (input?.value || '').trim();
        if (!txt) return;
        const user = state.wallet.connected ? shortAddr(state.wallet.address) : 'Guest';
        const msg = { id: uid(), user, text: txt, ts: Date.now(), tag: extractTag(txt) };
        state.chat.messages.push(msg);
        state.chat.users.add(user);
        persist();
        input.value = '';
        renderChat();
      }

      function extractTag(txt) {
        const m = txt.match(/#([a-z0-9_-]{2,24})/i);
        return m ? m[1].toLowerCase() : 'general';
      }

      // ---------- TRADING ----------

      function renderTrading() {
        // mock data updated by ticker loop
        $('#orderbook').textContent = `bids: ${randInt(3,8)} | asks: ${randInt(3,8)} | spread: ${rand(0.0001, 0.001).toFixed(4)}`;
        $('#trades').textContent = Array.from({length: 6}).map(()=>tradeLine()).join('\n');
      }

      function tradeLine() {
        const side = Math.random() > 0.5 ? 'BUY' : 'SELL';
        const px = state.metrics.price ?? rand(0.001, 0.02);
        const sz = rand(100, 10000).toFixed(0);
        return `${timeStr()} · ${side} ${sz} XRBC @ $${(+px).toFixed(5)}`;
      }

      function setAlert() {
        const v = parseFloat($('#alertPrice').value);
        if (!isFinite(v) || v <= 0) { $('#alertStatus').textContent = 'invalid'; return; }
        state.alerts.push({ id: uid(), price: v, fired: false });
        $('#alertStatus').textContent = `set @ $${v.toFixed(5)}`;
        persist();
      }

      // ---------- NFTS ----------

      function renderGallery() {
        const q = ($('#nftSearch')?.value || '').toLowerCase();
        const tag = $('#nftFilterTag')?.value || '';
        const host = $('#gallery');
        host.textContent = '';

        // Tags filter populate
        const tagSel = $('#nftFilterTag');
        if (tagSel && tagSel.options.length <= 1) {
          const tags = Array.from(new Set(state.nfts.flatMap(n => n.tags || []))).sort();
          tags.forEach(t => {
            const opt = document.createElement('option');
            opt.value = t; opt.textContent = t;
            tagSel.append(opt);
          });
        }

        state.nfts
          .filter(n => (!q || (n.name.toLowerCase().includes(q) || n.creator.toLowerCase().includes(q))) && (!tag || n.tags?.includes(tag)))
          .forEach(n => host.appendChild(renderNft(n)));
      }

      function renderNft(n) {
        const card = document.createElement('div'); card.className = 'card';
        const img = document.createElement('img');
        img.alt = n.name; img.loading = 'lazy';
        img.src = n.image || placeholderSVG(n.name);
        img.style.aspectRatio = '1/1';
        img.style.objectFit = 'cover';
        img.addEventListener('click', () => openModalNft(n));
        const cap = document.createElement('div'); cap.className = 'cap';
        cap.innerHTML = `
          <strong>${escapeHtml(n.name)}</strong>
          <div class="muted">by ${escapeHtml(n.creator)}</div>
          <div>${(n.tags || []).map(t => `<span class="tag">${escapeHtml(t)}</span>`).join(' ')}</div>
        `;
        card.append(img, cap);
        return card;
      }

      function openModalNft(n) {
        const body = $('#modalBody');
        $('#modalTitle').textContent = n.name;
        body.innerHTML = `
          <div style="display:grid;gap:10px;">
            <img alt="${escapeHtml(n.name)}" src="${n.image || placeholderSVG(n.name)}" style="border-radius:12px;border:1px solid rgba(90,247,255,0.2)" />
            <div class="mono">Creator: ${escapeHtml(n.creator)}</div>
            <div>Tags: ${(n.tags
