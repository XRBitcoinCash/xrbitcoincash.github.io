<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Safely trade XRBC · XRBitcoinCash</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Canonical -->
  <link rel="canonical" href="https://xrbitcoincash.com/trade.html" />
  <link rel="alternate" hreflang="en" href="https://xrbitcoincash.com/trade.html" />

  <!-- Primary SEO -->
  <meta name="description" content="Safely trade XRBC on the XRP Ledger. Connect your Xaman (Xumm) wallet to place XRBC/XRP limit or market orders, read the order book, and view AMM pool info." />
  <meta name="keywords" content="XRBitcoinCash, XRBC, XRP Ledger, XRPL, Xaman, Xumm, DEX, AMM, crypto trading, trustline" />
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="theme-color" content="#0b0f14" />

  <!-- Favicons -->
  <link rel="icon" href="/xrbc-nft.png" type="image/png">
  <link rel="shortcut icon" href="/xrbc-nft.png" type="image/png">
  <link rel="apple-touch-icon" href="/xrbc-nft.png">
  <meta name="msapplication-TileImage" content="/xrbc-nft.png">
  <link rel="icon" href="/favicon.ico?v=1" sizes="any">
  <link rel="icon" type="image/png" href="/favicons/favicon-32.png?v=1" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicons/favicon-16.png?v=1" sizes="16x16">
  <link rel="apple-touch-icon" href="/favicons/apple-touch-icon.png?v=1" sizes="180x180">
  <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg?v=1" color="#0b0f14">
  <meta name="msapplication-TileColor" content="#0b0f14">
  <link rel="manifest" href="/site.webmanifest?v=1">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="XRBitcoinCash">
  <meta property="og:title" content="Safely trade XRBC · XRBitcoinCash">
  <meta property="og:description" content="Decentralized XRBC/XRP trading on the XRP Ledger with live order book and AMM price helper.">
  <meta property="og:url" content="https://xrbitcoincash.com/trade.html">
  <meta property="og:image" content="https://xrbitcoincash.com/xrbc-nft.png">
  <meta property="og:image:secure_url" content="https://xrbitcoincash.com/xrbc-nft.png">
  <meta property="og:image:alt" content="XRBitcoinCash — XRBC/XRP trading page">

  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Safely trade XRBC · XRBitcoinCash">
  <meta name="twitter:description" content="Trade XRBC on XRPL. Connect your wallet, place orders, and view AMM pool info.">
  <meta name="twitter:image" content="https://xrbitcoincash.com/xrbc-nft.png">
  <meta name="twitter:image:alt" content="XRBitcoinCash — XRBC/XRP trading page">

  <!-- JSON-LD (kept, wired to page) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Safely trade XRBC · XRBitcoinCash",
    "url": "https://xrbitcoincash.com/trade.html",
    "description": "Safely trade XRBC on the XRP Ledger. Connect your Xaman (Xumm) wallet to place XRBC/XRP limit or market orders, read the order book, and view AMM pool info.",
    "isPartOf": {
      "@type": "WebSite",
      "name": "XRBitcoinCash",
      "url": "https://xrbitcoincash.com/"
    },
    "primaryImageOfPage": {
      "@type": "ImageObject",
      "url": "https://xrbitcoincash.com/xrbc-nft.png"
    },
    "about": {
      "@type": "Cryptocurrency",
      "name": "XRBitcoinCash (XRBC)",
      "alternateName": "XRBC",
      "additionalProperty": [
        { "@type": "PropertyValue", "name": "issuer", "value": "rEjwniYhYR5QDZzK1a1x2359j8j8N43Ypw" },
        { "@type": "PropertyValue", "name": "currency_hex", "value": "5852626974636F696E6361736800000000000000" },
        { "@type": "PropertyValue", "name": "network", "value": "XRP Ledger (XRPL)" }
      ]
    },
    "potentialAction": [{ "@type": "BuyAction", "target": "https://xrbitcoincash.com/trade.html" }]
  }
  </script>

  <meta name="ai-readable" content="This page exposes structured data (JSON-LD) describing the XRBC trading interface on XRPL, including issuer and currency hex.">

  <!-- =========================
       XRBC — Compact, Exchange-Style CSS
       ========================= -->
  <style>
/* ========= Neon / Glow pack (drop-in) ========= */

/* Shared glow tokens + animation */
:root{
  --glow-blur: 14px;
  --glow-opacity: .75;
}
@keyframes glowPulse{ 0%{opacity:.55;transform:translateY(0)} 50%{opacity:.25} 100%{opacity:.6} }

/* Header soft auras */
.header-wrap::after{
  content:""; position:absolute; inset:-8px -6px; pointer-events:none; z-index:0;
  background:
    radial-gradient(42% 100% at 10% 50%, rgba(0,182,255,.22), transparent 60%),
    radial-gradient(28% 70% at 95% 25%, rgba(0,182,255,.16), transparent 70%);
  filter:blur(8px); opacity:.9;
}

/* ===== Buttons & pills (glow by element, no HTML changes) ===== */
#downloadXamanBtn,
#setTrustlineBtn,
#connectWalletBtn,
#disconnectWalletBtn,
#placeOfferBtn,
.best-price-btn,
.nav-pill{
  position:relative; z-index:0;
}
#downloadXamanBtn::after,  /* blue */
.nav-pill::after{
  content:""; position:absolute; inset:-8px; border-radius:14px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(96,165,250,.85), transparent 70%);
  transition:opacity .2s ease, filter .2s ease;
}
.nav-pill:hover::after{ opacity:.95; filter:blur(16px); }

#setTrustlineBtn::after{     /* amber */
  content:""; position:absolute; inset:-8px; border-radius:14px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(234,179,8,.85), transparent 70%);
  animation:glowPulse 2.2s ease-in-out infinite;
}
#connectWalletBtn::after{    /* green */
  content:""; position:absolute; inset:-8px; border-radius:14px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(34,197,94,.85), transparent 70%);
  animation:glowPulse 1.9s ease-in-out infinite;
}
#disconnectWalletBtn::after{ /* red */
  content:""; position:absolute; inset:-8px; border-radius:14px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(239,68,68,.85), transparent 70%);
  animation:glowPulse 2.6s ease-in-out infinite;
}
.best-price-btn::after{      /* cyan */
  content:""; position:absolute; inset:-8px; border-radius:10px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(34,211,238,.85), transparent 70%);
}

/* Make the primary submit mirror side (buy/sell) */
#tradeCard.buy  #placeOfferBtn{
  border-color:rgba(34,197,94,.65);
  box-shadow:inset 0 0 0 2px rgba(34,197,94,.22), 0 0 22px rgba(34,197,94,.28);
}
#tradeCard.buy  #placeOfferBtn::after{
  content:""; position:absolute; inset:-8px; border-radius:10px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(34,197,94,.85), transparent 70%);
}
#tradeCard.sell #placeOfferBtn{
  border-color:rgba(239,68,68,.65);
  box-shadow:inset 0 0 0 2px rgba(239,68,68,.22), 0 0 22px rgba(239,68,68,.28);
}
#tradeCard.sell #placeOfferBtn::after{
  content:""; position:absolute; inset:-8px; border-radius:10px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(239,68,68,.85), transparent 70%);
}

/* ===== Order-type tabs: neon outline text + colored borders ===== */
.otype{
  /* neon hollow text */
  color:transparent;
  -webkit-text-stroke:1px #000;
  text-shadow:
    0 0 2px rgba(255,255,255,.95),
    0 0 6px rgba(255,255,255,.85);
  overflow:visible; /* let glow spill */
}
.otype[data-type="limit"]{
  border-color:rgba(234,179,8,.90);
  box-shadow:inset 0 0 0 2px rgba(234,179,8,.18);
}
.otype[data-type="limit"].active{
  box-shadow:
    inset 0 0 0 2px rgba(234,179,8,.22),
    0 0 0 1px rgba(96,165,250,.35);
}
.otype[data-type="limit"]::after{
  content:""; position:absolute; inset:-10px; border-radius:12px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:.7;
  background:radial-gradient(closest-side, rgba(234,179,8,.75), transparent 70%);
}
.otype[data-type="market"]{
  border-color:rgba(34,197,94,.90);
  box-shadow:inset 0 0 0 2px rgba(34,197,94,.18);
}
.otype[data-type="market"].active{
  box-shadow:
    inset 0 0 0 2px rgba(34,197,94,.22),
    0 0 0 1px rgba(96,165,250,.35);
}
.otype[data-type="market"]::after{
  content:""; position:absolute; inset:-10px; border-radius:12px; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:.7;
  background:radial-gradient(closest-side, rgba(34,197,94,.75), transparent 70%);
}

/* Light-mode legibility for neon outline */
body.light-mode .otype{
  -webkit-text-stroke:1px #000 !important;
  text-shadow:
    0 0 2px rgba(255,255,255,.90),
    0 0 6px rgba(255,255,255,.80);
}

/* ===== Buy/Sell tabs: stronger “selected” glow ===== */
.tab.buy.active{
  border-color:rgba(34,197,94,.65);
  box-shadow:inset 0 0 0 2px rgba(34,197,94,.22), 0 0 18px rgba(34,197,94,.18);
}
.tab.sell.active{
  border-color:rgba(239,68,68,.65);
  box-shadow:inset 0 0 0 2px rgba(239,68,68,.22), 0 0 18px rgba(239,68,68,.18);
}

/* ===== Asset chips: give a soft inner glow ===== */
.asset-chip{
  box-shadow:inset 0 0 0 2px rgba(96,165,250,.18);
}
.asset-xrp{
  box-shadow:
    inset 0 0 0 2px rgba(34,197,94,.18),
    0 0 22px rgba(34,197,94,.22);
  border-color:rgba(34,197,94,.55);
}
.asset-xrbc{
  box-shadow:
    inset 0 0 0 2px rgba(96,165,250,.18),
    0 0 22px rgba(96,165,250,.22);
  border-color:rgba(96,165,250,.55);
}
body.light-mode .asset-chip{ box-shadow:none; border-color:#000; }

/* ===== Reduced motion: keep the glow, stop the pulse ===== */
@media (prefers-reduced-motion:reduce){
  *{ animation:none !important; }
}

/* ========= OPTIONAL: utility classes if you want manual control ========= */
/* Add: class="btn glow glow-green" (etc). Not required with the ID rules above. */
.glow{ position:relative; z-index:0; }
.glow::after{
  content:""; position:absolute; inset:-8px; border-radius:inherit; z-index:-1; pointer-events:none;
  filter:blur(var(--glow-blur)); opacity:var(--glow-opacity);
  background:radial-gradient(closest-side, rgba(255,255,255,.85), transparent 70%);
}
.glow.pulse::after{ animation:glowPulse 2.2s ease-in-out infinite; }
.glow-blue::after{  background:radial-gradient(closest-side, rgba(96,165,250,.85), transparent 70%); }
.glow-cyan::after{  background:radial-gradient(closest-side, rgba(34,211,238,.85), transparent 70%); }
.glow-green::after{ background:radial-gradient(closest-side, rgba(34,197,94,.85),  transparent 70%); }
.glow-yellow::after{background:radial-gradient(closest-side, rgba(234,179,8,.85),  transparent 70%); }
.glow-red::after{   background:radial-gradient(closest-side, rgba(239,68,68,.85),  transparent 70%); }

  </style>
</head>
<body>

  <!-- ===== Header ===== -->
  <header class="site-header">
    <div class="header-wrap">
      <div class="brand">
        <img src="/xrbc-nft.png" alt="XRBitcoinCash (XRBC) logo">
        <h1>XRBitcoinCash</h1>
      </div>

      <nav class="header-center" role="navigation" aria-label="Primary">
        <div class="header-nav">
          <a class="nav-pill" href="/xrbc-ecosystem.html" title="XRBC Ecosystem · DEX/AMM">XRBC Ecosystem · DEX/AMM</a>
          <a class="nav-pill" href="/whitepaper.html" title="XRBC White Paper">White Paper</a>
        </div>
      </nav>

      <div class="header-right">
        <button id="themeToggle" type="button" aria-pressed="false" aria-label="Toggle light/dark">Light/Dark</button>
      </div>
    </div>
  </header>

  <!-- ===== Main ===== -->
  <main class="container" style="text-align:center;">

    <h1 style="margin:12px 0 8px; line-height:1.1; letter-spacing:.2px;">
      XRBC · Decentralized Trading (XRPL via Xaman)
    </h1>

    <!-- xApp quick entries -->
    <div style="margin-top:12px">
      <div style="display:flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid #064e3b;border-left:4px solid #10b981;border-radius:10px;background:linear-gradient(180deg,#052b1f,#073425);color:#d1fae5;font-size:14px;font-weight:700;letter-spacing:.2px;margin-bottom:10px;justify-content:center">
        <span>Open in Xaman — DEX & Swaps (mobile opens app • desktop shows QR)</span>
      </div>

      <a href="https://xumm.app/detect/xapp:xumm.dex" rel="noopener noreferrer"
         class="btn" style="width:100%;max-width:520px;margin:0 auto 10px;border-left:4px solid #10b981;">
        <img src="/xrbc-nft.png" alt="XRBC" width="20" height="20" style="display:inline-block;border-radius:4px" />
        <span>Open in Xaman — Trade XRBC ↔ XRP (DEX)</span>
        <img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" width="20" height="20" style="display:inline-block" />
      </a>

      <a href="https://xumm.app/detect/xapp:anodos.swap" rel="noopener noreferrer"
         class="btn" style="width:100%;max-width:520px;margin:0 auto 10px;border-left:4px solid #38bdf8;">
        <img src="/xrbc-nft.png" alt="XRBC" width="20" height="20" style="display:inline-block;border-radius:4px" />
        <span>Open in Xaman — ANODOS Swap (XRBC ↔ XRP)</span>
        <img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" width="20" height="20" style="display:inline-block" />
      </a>

      <a href="https://xumm.app/detect/xapp:magnetic.dex" rel="noopener noreferrer"
         class="btn" style="width:100%;max-width:520px;margin:0 auto 10px;border-left:4px solid #1e3a8a;">
        <img src="/xrbc-nft.png" alt="XRBC" width="20" height="20" style="display:inline-block;border-radius:4px" />
        <span>Open in Xaman — Magnetic (XRBC ↔ XRP)</span>
        <img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" width="20" height="20" style="display:inline-block" />
      </a>

      <div class="fine" style="margin-top:8px;color:#93a3af;font-size:12px;line-height:1.4;">
        Notes: Anodos and Magnetic open as xApps in Xaman. Pair deep-linking to XRBC/XRP isn’t publicly documented by providers; you may need to select the pair in-app.
        “XRP” and the XRP logo are trademarks of Ripple Labs, Inc. “Xaman (Xumm)” is a product of XRPL Labs. No affiliation or endorsement implied.
      </div>
    </div>

    <!-- Wallet card -->
    <div class="card wallet-card" style="margin:16px 0 20px; position:relative;">
      <h2 class="wallet-title">
        <img src="/xrbc-nft.png" alt="XRBC logo">
        <span>Connect wallet to the XRBC decentralized exchange</span>
      </h2>

      <div class="wallet-actions">
        <button id="downloadXamanBtn" class="btn" style="border-left:4px solid #2563eb;">Download Xaman</button>
        <button id="setTrustlineBtn" class="btn">Set XRBC Trustline</button>
        <button id="connectWalletBtn" class="btn">Connect Wallet</button>
        <button id="disconnectWalletBtn" class="btn" disabled>Disconnect</button>
      </div>

      <p id="walletStatus" class="status-text">Status: Not connected</p>
      <div id="trustlineMsg" class="status-text" style="margin-top:8px;"></div>

      <!-- Download popover -->
      <div id="dlPopover" class="qr-popover" role="dialog" aria-label="Download Xaman QR" aria-hidden="true">
        <div class="qr"><img id="dlQr" alt="Scan to download Xaman" width="180" height="180" decoding="async" loading="eager"></div>
        <div class="label">Scan to download Xaman</div>
      </div>
    </div>

    <!-- ===== Trading UI ===== -->
    <section class="trade-card" id="tradeCard" aria-label="XRBC Trading">

      <!-- Pair chips -->
      <div class="trade-logo">
        <span class="asset-chip asset-xrbc">
          <img src="/xrbc-nft.png" alt="XRBC"> XRBC
        </span>
        <span class="nowrap">/</span>
        <span class="asset-chip asset-xrp">
          <img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" style="background:#fff;border-radius:3px;padding:1px"> XRP
        </span>
      </div>

      <!-- Order type -->
      <div class="otype-tabs" role="tablist" aria-label="Order type">
        <button class="otype active" data-type="limit"  role="tab" aria-selected="true">Limit (Advanced)</button>
        <button class="otype"        data-type="market" role="tab" aria-selected="false">Market (Beginner)</button>
      </div>

      <!-- Order type notes -->
      <div id="otypeNotes" aria-live="polite" class="status-text">
        <div data-note="limit"><strong>Limit:</strong> Place an order at <em>your</em> price. It executes only if the market reaches that price.</div>
        <div data-note="market" hidden><strong>Market:</strong> Executes now at the best available price (IOC). You’ll review & sign in Xaman.</div>
      </div>

      <!-- Buy/Sell -->
      <div class="tabset" role="tablist" aria-label="Choose buy or sell">
        <button id="buyTab" class="tab buy active"  type="button" role="tab" aria-selected="true">Buy XRBC</button>
        <button id="sellTab" class="tab sell" type="button" role="tab" aria-selected="false">Sell XRBC</button>
      </div>

      <!-- Side explain -->
      <div id="sideExplain" aria-live="polite" style="margin-top:6px">
        <div class="status-text" data-side="buy" id="buyNote">
          <strong>Buying XRBC:</strong> You’re trading
          <span class="asset-chip asset-xrp"><img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" style="height:1.05em;width:auto;vertical-align:-.2em;background:#fff;border-radius:3px;padding:1px"> XRP</span>
          to receive
          <span class="asset-chip asset-xrbc"><img src="/xrbc-nft.png" alt="XRBC" style="height:1.05em;width:auto;vertical-align:-.2em;border-radius:3px"> XRBC</span>.
        </div>
        <div class="status-text" data-side="sell" id="sellNote" hidden>
          <strong>Selling XRBC:</strong> You’re trading
          <span class="asset-chip asset-xrbc"><img src="/xrbc-nft.png" alt="XRBC" style="height:1.05em;width:auto;vertical-align:-.2em;border-radius:3px"> XRBC</span>
          to receive
          <span class="asset-chip asset-xrp"><img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" style="height:1.05em;width:auto;vertical-align:-.2em;background:#fff;border-radius:3px;padding:1px"> XRP</span>.
        </div>
      </div>

      <!-- Amount -->
      <div class="field" style="margin-top:8px">
        <label for="amount" id="amountLabel">Amount (XRBC)</label>
        <div class="amount-row">
          <img src="/xrbc-nft.png" alt="XRBC logo">
          <input id="amount" type="number" step="0.000001" inputmode="decimal" placeholder="0.000000">
        </div>

        <!-- % chips -->
        <div class="quick-amounts" role="group" aria-label="Quick amount">
          <button class="qa" data-q="25">25%</button>
          <button class="qa" data-q="50">50%</button>
          <button class="qa" data-q="75">75%</button>
          <button class="qa" data-q="100">100%</button>
        </div>

        <!-- Hint -->
        <div class="inline-hint" id="amountHint" style="margin-top:6px">
          How many XRBC you want to <span id="actionWord">buy</span>.
          <span class="nowrap">You’re trading
            <span class="asset-chip asset-xrp"><img src="https://xrbitcoincash.github.io/assetsxrp.svg.svg" alt="XRP" style="height:1.05em;width:auto;vertical-align:-.2em;background:#fff;border-radius:3px;padding:1px"> XRP</span>
            to receive
            <span class="asset-chip asset-xrbc"><img src="/xrbc-nft.png" alt="XRBC" style="height:1.05em;width:auto;vertical-align:-.2em;border-radius:3px"> XRBC</span>.
          </span>
        </div>
      </div>

      <!-- Best Price -->
      <div class="best-price-strip" style="margin-top:10px">
        <button class="best-price-btn" id="suggestPriceBtn" type="button">Best Price (AMM)</button>
        <div class="hint">Auto-updates every 10s after you enter an <strong>Amount</strong>.</div>
      </div>

      <!-- Price (hidden for Market) -->
      <div class="field" id="priceField">
        <label for="price">Price (XRP per XRBC)</label>
        <input id="price" type="number" step="0.000001" inputmode="decimal" placeholder="e.g., 0.500000">
        <div class="inline-hint">Limit price. (Use Market to execute immediately.)</div>
      </div>

      <!-- Total -->
      <div class="total-line" aria-live="polite">
        <span>Total</span>
        <strong id="totalXrp">0.000000 XRP</strong>
      </div>

      <!-- Submit -->
      <div class="button-row">
        <button id="placeOfferBtn" class="btn btn-primary" type="button">Place Order</button>
        <div class="status-text" id="autoRefreshNote">Auto-refresh every 10s</div>
      </div>

      <p id="tradeMsg" class="status-text">—</p>

      <!-- Internal state -->
      <select id="side" hidden>
        <option value="buy" selected>Buy</option>
        <option value="sell">Sell</option>
      </select>
      <input id="orderType" type="hidden" value="limit">
    </section>

    <!-- ===== Live Metrics ===== -->
    <section class="card" id="xrbcDexHero" aria-label="XRBC DEX — Live Metrics" style="margin:20px 0 24px; text-align:left;">
      <h2 style="margin:0 0 8px;display:flex;align-items:center;gap:10px">
        <img src="/xrbc-nft.png" alt="XRBC" width="24" height="24" style="border-radius:6px;border:1px solid var(--line)">
        XRBC DEX — Live Metrics
      </h2>
      <p id="metricsStatus" class="status-text" style="margin:0 0 6px;">—</p>

      <div style="display:grid;gap:16px;margin-top:6px">
        <div>
          <h3 style="margin:0 0 6px">XRBC/XRP Order Book (top 5)</h3>
          <div id="priceOutput">—</div>
        </div>
        <div>
          <h3 style="margin:6px 0">Ledger (validated)</h3>
          <pre id="ledgerOutput" style="text-align:left;margin:0">—</pre>
        </div>
        <div>
          <h3 style="margin:6px 0">AMM Pool (mini)</h3>
          <div id="ammPoolOutput">—</div>
        </div>
      </div>
    </section>

  </main>

  <!-- Config (kept) -->
  <script type="application/json" id="app-config">
  {
    "xummApiKey": "2abde023-0df1-49a2-a4dc-86d776f6318d",
    "proxyUrl": "https://xrbitcoincash-github-io.onrender.com"
  }
  </script>

  <!-- Xaman SDK -->
  <script src="https://xaman.app/assets/cdn/xumm.min.js"></script>

  <!-- Main JS (cleaned, single IIFE) -->
  <script>
(function(){
  // ==== Config ====
  const cfgNode = document.getElementById("app-config");
  const cfg = JSON.parse((cfgNode && cfgNode.textContent) || "{}");
  const PROXY_URL = cfg.proxyUrl;
  const XUMM_API_KEY = cfg.xummApiKey;
  const XRP_TO_DROPS = 1_000_000;

  const XRBC = {
    currency: "5852626974636F696E6361736800000000000000",
    issuer: "rEjwniYhYR5QDZzK1a1x2359j8j8N43Ypw"
  };

  // ==== Helpers ====
  async function xrplRequest(payload) {
    const res = await fetch(PROXY_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    if (!res.ok) throw new Error("Proxy HTTP " + res.status);
    const data = await res.json();
    if (data && data.error) throw new Error("XRPL: " + JSON.stringify(data.error));
    return data;
  }
  const toDrops = (xrp) => Math.round(Number(xrp) * XRP_TO_DROPS).toString();

  function setText(el, s){ if (el) el.textContent = s; }
  function $(id){ return document.getElementById(id); }

  // Theme toggle
  (function themeInit(){
    const btn = $("themeToggle");
    const saved = localStorage.getItem("xrbc-theme");
    if (saved === "light") document.body.classList.add("light-mode");
    const sync = () => { if(btn) btn.setAttribute("aria-pressed", document.body.classList.contains("light-mode") ? "true" : "false"); };
    if(btn) btn.addEventListener("click", () => {
      document.body.classList.toggle("light-mode");
      localStorage.setItem("xrbc-theme", document.body.classList.contains("light-mode") ? "light" : "dark");
      sync();
    });
    sync();
  })();

  // ==== Wallet / Xaman ====
  let xumm = null;
  try { if (window.Xumm) xumm = new Xumm(XUMM_API_KEY); } catch(e){}

  const connectBtn    = $("connectWalletBtn");
  const disconnectBtn = $("disconnectWalletBtn");
  const statusEl      = $("walletStatus");
  const trustlineMsg  = $("trustlineMsg");

  function setConnectedUI(acct){
    setText(statusEl, "Connected: " + acct);
    window.__xrbcWallet = acct;
    localStorage.setItem("xrbcWallet", acct);
    if (disconnectBtn) disconnectBtn.disabled = false;
    if (connectBtn) connectBtn.disabled = true;
  }
  function setDisconnectedUI(){
    setText(statusEl, "Status: Not connected");
    window.__xrbcWallet = null;
    localStorage.removeItem("xrbcWallet");
    if (disconnectBtn) disconnectBtn.disabled = true;
    if (connectBtn) connectBtn.disabled = false;
  }
  async function refreshWalletStatus(){
    try {
      if (!xumm) return;
      const acct = await xumm.user.account;
      if (acct) setConnectedUI(acct);
    } catch {}
  }

  // Restore session
  const savedAcct = localStorage.getItem("xrbcWallet");
  if (savedAcct) setConnectedUI(savedAcct);
  if (xumm) {
    xumm.on("ready", refreshWalletStatus);
    window.addEventListener("visibilitychange", () => { if (!document.hidden) refreshWalletStatus(); });
    window.addEventListener("focus", refreshWalletStatus);
  }

  if (connectBtn) connectBtn.addEventListener("click", async () => {
    try {
      setText(statusEl, "Waiting for Xaman… (scan QR if shown)");
      await xumm.authorize();
      const acct = await xumm.user.account;
      if (acct) setConnectedUI(acct);
      else setText(statusEl, "Still waiting for Xaman…");
    } catch (e){
      setText(statusEl, "Failed to connect wallet");
    }
  });

  if (disconnectBtn) disconnectBtn.addEventListener("click", () => {
    setDisconnectedUI();
    try { xumm && xumm.logout(); } catch {}
  });

  // Trustline
  const setTrustBtn = $("setTrustlineBtn");
  if (setTrustBtn) setTrustBtn.addEventListener("click", async () => {
    setText(trustlineMsg, "Preparing trustline request…");
    try {
      if (!xumm) throw new Error("Wallet SDK not available.");
      const acct = window.__xrbcWallet || undefined;
      const txjson = {
        TransactionType: "TrustSet",
        LimitAmount: { currency: XRBC.currency, issuer: XRBC.issuer, value: "1000000" }
      };
      if (acct) txjson.Account = acct;

      const { created, resolved } = await xumm.payload.createAndSubscribe({ txjson }, (ev) => {
        if (ev?.opened) setText(trustlineMsg, "Open Xaman (or scan QR) to review…");
        if (ev?.signed === false) setText(trustlineMsg, "Trustline rejected.");
      });

      if (created?.refs?.qr_png) {
        trustlineMsg.innerHTML = "Scan to sign trustline:<br/>";
        const qr = document.createElement("img");
        qr.src = created.refs.qr_png;
        qr.alt = "Scan with Xaman to set XRBC trustline";
        qr.style.maxWidth = "240px";
        qr.style.marginTop = "12px";
        trustlineMsg.appendChild(qr);
      }

      const result = await resolved;
      if (!result.signed) { setText(trustlineMsg, "Trustline not signed."); return; }
      setText(trustlineMsg, "✅ Trustline set successfully!");
    } catch (err){
      setText(trustlineMsg, "Error: " + (err?.message || err));
    }
  });

  // Download Xaman popover
  (function initDownloadPopover(){
    const downloadBtn = $("downloadXamanBtn");
    const pop = $("dlPopover");
    const qrImg = $("dlQr");
    const actions = downloadBtn && downloadBtn.closest(".wallet-actions");
    if (!downloadBtn || !pop || !actions) return;
    const DOWNLOAD_URL = "https://xaman.app/download";
    if (qrImg && !qrImg.src){
      qrImg.src = "https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=" + encodeURIComponent(DOWNLOAD_URL);
    }
    function hide(){ pop.classList.remove("show"); pop.setAttribute("aria-hidden","true"); }
    function show(){
      pop.style.visibility = "hidden";
      pop.classList.add("show");
      const br = downloadBtn.getBoundingClientRect();
      const ar = actions.getBoundingClientRect();
      const pw = pop.offsetWidth, ph = pop.offsetHeight;
      const top = (br.top - ar.top) + (br.height/2) - (ph/2);
      const left = (br.left - ar.left) - pw - 12;
      pop.style.top = Math.max(0, top) + "px";
      pop.style.left = Math.max(0, left) + "px";
      pop.style.visibility = "";
      pop.setAttribute("aria-hidden","false");
    }
    downloadBtn.addEventListener("click", (e) => {
      if (/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)) { window.location.href = DOWNLOAD_URL; return; }
      e.preventDefault();
      if (pop.classList.contains("show")) hide(); else show();
    });
    document.addEventListener("click", (e) => { if (!pop.classList.contains("show")) return; if (e.target===downloadBtn || pop.contains(e.target)) return; hide(); });
    window.addEventListener("resize", hide);
    window.addEventListener("scroll", hide, { passive:true });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") hide(); });
  })();

  // ==== Trading UI ====
  const placeOfferBtn = $("placeOfferBtn");
  const sideEl   = $("side");
  const amountEl = $("amount");
  const priceEl  = $("price");
  const totalXrpEl = $("totalXrp");
  const suggestBtn = $("suggestPriceBtn");
  const orderTypeEl = $("orderType");
  const priceField  = $("priceField");
  const tradeCard   = $("tradeCard");
  const tradeMsg    = $("tradeMsg");
  const buyTab = $("buyTab");
  const sellTab = $("sellTab");
  const amountHint = $("amountHint");
  const amountLabel = $("amountLabel");
  const buyNote = $("buyNote");
  const sellNote = $("sellNote");

  function recalcTotals(){
    const amt = Number(amountEl?.value) || 0;
    const px  = Number(priceEl?.value) || 0;
    const total = (px * amt) || 0;
    setText(totalXrpEl, total.toFixed(6) + " XRP");
  }
  if (amountEl) amountEl.addEventListener("input", recalcTotals);
  if (priceEl)  priceEl.addEventListener("input", recalcTotals);

  function setSide(side){
    if (sideEl) sideEl.value = side;
    if (side === "buy"){
      buyTab?.classList.add("active"); buyTab?.setAttribute("aria-selected","true");
      sellTab?.classList.remove("active"); sellTab?.setAttribute("aria-selected","false");
      tradeCard?.classList.add("buy"); tradeCard?.classList.remove("sell");
      if (amountLabel) amountLabel.textContent = "Amount (XRBC)";
      if (amountHint) amountHint.querySelector("#actionWord").textContent = "buy";
      if (buyNote){ buyNote.hidden = false; } if (sellNote){ sellNote.hidden = true; }
    } else {
      sellTab?.classList.add("active"); sellTab?.setAttribute("aria-selected","true");
      buyTab?.classList.remove("active"); buyTab?.setAttribute("aria-selected","false");
      tradeCard?.classList.add("sell"); tradeCard?.classList.remove("buy");
      if (amountLabel) amountLabel.textContent = "Amount (XRBC)";
      if (amountHint) amountHint.querySelector("#actionWord").textContent = "sell";
      if (buyNote){ buyNote.hidden = true; } if (sellNote){ sellNote.hidden = false; }
    }
    recalcTotals();
  }
  buyTab?.addEventListener("click", () => setSide("buy"));
  sellTab?.addEventListener("click", () => setSide("sell"));
  setSide(sideEl?.value || "buy");

  // Order type tabs
  (function initOrderType(){
    const typeBtns = document.querySelectorAll(".otype-tabs .otype");
    const notes = $("otypeNotes");
    function showNote(t){
      if (!notes) return;
      notes.querySelectorAll("[data-note]").forEach(n => {
        n.hidden = n.getAttribute("data-note") !== t;
      });
    }
    typeBtns.forEach(btn => btn.addEventListener("click", () => {
      typeBtns.forEach(b => {
        b.classList.toggle("active", b === btn);
        b.setAttribute("aria-selected", b===btn ? "true" : "false");
      });
      const t = btn.dataset.type; // 'limit' | 'market'
      if (orderTypeEl) orderTypeEl.value = t;
      if (t === "limit"){ priceField.hidden = false; placeOfferBtn.textContent = "Place Limit Order"; }
      if (t === "market"){ priceField.hidden = true; placeOfferBtn.textContent = "Place Market Order"; }
      showNote(t);
      recalcTotals();
    }));
    showNote(orderTypeEl?.value || "limit");
  })();

  // Balances for % chips
  const BAL = { xrp: 0, xrbc: 0 };
  const RESERVE_BUFFER_XRP = 1.0;
  const normalizeHex = (s) => (s || "").toUpperCase().replace(/0+$/,"");

  async function fetchBalances(){
    const acct = window.__xrbcWallet;
    if (!acct){ BAL.xrp = 0; BAL.xrbc = 0; return BAL; }
    try {
      const info = await xrplRequest({ method:"account_info", params:[{ account:acct, ledger_index:"validated" }] });
      BAL.xrp = Number(info?.result?.account_data?.Balance || 0) / XRP_TO_DROPS;
    } catch { BAL.xrp = 0; }
    try {
      const lines = await xrplRequest({ method:"account_lines", params:[{ account:acct, peer:XRBC.issuer, ledger_index:"validated" }] });
      const tl = (lines?.result?.lines || []).find(l => normalizeHex(l.currency) === normalizeHex(XRBC.currency));
      BAL.xrbc = tl ? Math.max(0, Number(tl.balance || 0)) : 0;
    } catch { BAL.xrbc = 0; }
    return BAL;
  }
  window.addEventListener("focus", () => { if (window.__xrbcWallet) fetchBalances(); });
  if (window.__xrbcWallet) fetchBalances();

  (function initPercentChips(){
    const chips = document.querySelectorAll(".quick-amounts .qa");
    if (!chips.length) return;
    async function applyPercent(pct){
      const side = sideEl?.value || "buy";
      const orderType = orderTypeEl?.value || "limit";
      await fetchBalances();

      if (side === "sell"){
        const amt = Math.max(0, BAL.xrbc * (pct/100));
        if (amountEl){ amountEl.value = amt.toFixed(6); amountEl.dispatchEvent(new Event("input")); }
        return;
      }

      let price = Number(priceEl?.value) || 0;
      if (orderType === "market" || !price){
        await fillBestPrice();
        price = Number(priceEl?.value) || 0;
      }
      if (!price || price <= 0) return;

      const spendable = Math.max(0, (BAL.xrp - RESERVE_BUFFER_XRP)) * (pct/100);
      const amt = spendable > 0 ? (spendable / price) : 0;
      if (amountEl){ amountEl.value = amt.toFixed(6); amountEl.dispatchEvent(new Event("input")); }
    }
    chips.forEach(btn => btn.addEventListener("click", async () => {
      const pct = Number(btn.dataset.q || 0); if (!pct) return;
      btn.disabled = true; try { await applyPercent(pct); } finally { btn.disabled = false; }
    }));
  })();

  // AMM price helper
  async function fillBestPrice(){
    if (!sideEl || !amountEl || !priceEl) return;
    const side = sideEl.value;
    const amount = Number(amountEl.value);
    if (!amount || amount <= 0){ setText(tradeMsg, "Enter a valid XRBC amount."); return; }
    setText(tradeMsg, "Connecting to XRPL for best price…");

    try {
      const data = await xrplRequest({
        method: "amm_info",
        params: [{ asset: { currency: "XRP" }, asset2: { currency: XRBC.currency, issuer: XRBC.issuer } }]
      });
      const amm = data.result?.amm;
      if (!amm) throw new Error("No AMM found for XRBC/XRP");

      const reserveXrp  = parseFloat(amm.amount) / XRP_TO_DROPS;
      const reserveXrbc = parseFloat(amm.amount2.value);
      const feeRate     = amm.trading_fee / 1_000_000; // millionths

      const k = reserveXrp * reserveXrbc;
      let effectivePrice;

      if (side === "buy"){
        const newY = reserveXrbc - amount; if (newY <= 0) throw new Error("Amount exceeds pool depth.");
        const newX = k / newY;
        let xrpIn = newX - reserveXrp;
        xrpIn += xrpIn * feeRate;
        effectivePrice = xrpIn / amount;
      } else {
        const newY = reserveXrbc + amount;
        const newX = k / newY;
        let xrpOut = reserveXrp - newX;
        xrpOut -= xrpOut * feeRate;
        effectivePrice = xrpOut / amount;
      }

      priceEl.value = Number(effectivePrice).toFixed(6);
      recalcTotals();
      setText(tradeMsg, `Best price calculated from AMM pool (${side}).`);
      tradeMsg.classList.remove("err");
      tradeMsg.classList.add("ok");
    } catch (e){
      setText(tradeMsg, "Could not fetch AMM price.");
      tradeMsg.classList.remove("ok");
      tradeMsg.classList.add("err");
    }
  }
  suggestBtn?.addEventListener("click", fillBestPrice);

  // Auto-refresh AMM estimate if amount > 0
  setInterval(() => {
    const amt = Number(amountEl?.value);
    if (amt > 0) fillBestPrice().catch(()=>{});
  }, 10000);

  // Place Offer
  placeOfferBtn?.addEventListener("click", async () => {
    const orderType = orderTypeEl?.value || "limit";
    try {
      if (!xumm) throw new Error("Wallet SDK not available.");
      const account = window.__xrbcWallet;
      if (!account) throw new Error("Connect your wallet first.");

      const side = sideEl?.value || "buy";
      const amt = Number(amountEl?.value);
      let priceVal = Number(priceEl?.value);

      if (orderType === "market"){
        if (!amt || amt <= 0) throw new Error("Enter valid Amount.");
        await fillBestPrice();
        priceVal = Number(priceEl?.value);
        if (!priceVal || priceVal <= 0) throw new Error("Unable to fetch market estimate.");
      } else {
        if (!amt || !priceVal || amt <= 0 || priceVal <= 0) throw new Error("Enter valid Amount & Price.");
      }

      const xrpTotal = priceVal * amt;
      const TF_SELL = 0x00080000;
      const TF_IOC  = 0x00020000;

      let txjson;
      if (side === "sell"){
        txjson = {
          TransactionType: "OfferCreate",
          Account: account,
          TakerGets: { currency: XRBC.currency, issuer: XRBC.issuer, value: String(amt) },
          TakerPays: toDrops(xrpTotal),
          Flags: (orderType === "market") ? (TF_SELL | TF_IOC) : TF_SELL
        };
      } else {
        txjson = {
          TransactionType: "OfferCreate",
          Account: account,
          TakerGets: toDrops(xrpTotal),
          TakerPays: { currency: XRBC.currency, issuer: XRBC.issuer, value: String(amt) },
          Flags: (orderType === "market") ? TF_IOC : 0
        };
      }

      setText(tradeMsg, "Open Xaman to review & sign…");
      const { resolved } = await xumm.payload.createAndSubscribe({ txjson }, (ev) => {
        if (ev?.opened) setText(tradeMsg, "Payload opened in Xaman…");
        if (ev?.signed === false) setText(tradeMsg, "Order rejected.");
      });

      const result = await resolved;
      if (!result.signed){ setText(tradeMsg, "Order not signed."); return; }

      setText(tradeMsg, "Order submitted. Refreshing order book…");
      await refreshOrderBook();
    } catch (err){
      setText(tradeMsg, "Error: " + (err?.message || err));
      tradeMsg.classList.remove("ok");
      tradeMsg.classList.add("err");
    }
  });

  // ==== Live Metrics (Order Book, Ledger, AMM mini) ====
  const metricsStatus = $("metricsStatus");
  const bookOut = $("priceOutput");
  const ledgerOut = $("ledgerOutput");
  const ammOut = $("ammPoolOutput");

  function info(msg){ setText(metricsStatus, msg); metricsStatus?.classList.remove("ok","err"); }
  function ok(msg){ setText(metricsStatus, msg); metricsStatus?.classList.remove("err"); metricsStatus?.classList.add("ok"); }
  function fail(msg){ setText(metricsStatus, msg); metricsStatus?.classList.remove("ok"); metricsStatus?.classList.add("err"); }

  function priceFromOffer(of){
    if (!of) return null;
    const gets = of.TakerGets?.value ? parseFloat(of.TakerGets.value) : parseFloat(of.TakerGets) / XRP_TO_DROPS;
    const pays = of.TakerPays?.value ? parseFloat(of.TakerPays.value) : parseFloat(of.TakerPays) / XRP_TO_DROPS;
    if (!isFinite(gets) || !isFinite(pays) || gets <= 0) return null;
    return pays / gets; // XRP per XRBC
  }

  async function getOrderBookHtml(){
    async function side(taker_gets, taker_pays, sideName){
      const rows = [];
      try {
        const res = await xrplRequest({ method:"book_offers", params:[{ taker_gets, taker_pays, limit:5 }] });
        const offers = res?.result?.offers || [];
        if (!offers.length){
          rows.push(`<tr><td>${sideName}</td><td>No offers</td><td>-</td></tr>`);
        } else {
          for (const of of offers){
            const gets = of.TakerGets?.value ? parseFloat(of.TakerGets.value) : parseFloat(of.TakerGets) / XRP_TO_DROPS;
            const pays = of.TakerPays?.value ? parseFloat(of.TakerPays.value) : parseFloat(of.TakerPays) / XRP_TO_DROPS;
            const price = (isFinite(gets) && gets > 0) ? (pays / gets) : NaN;
            rows.push(`<tr><td>${sideName}</td><td>${isFinite(price)?price.toFixed(6):"—"}</td><td>${isFinite(gets)?gets.toFixed(2):"—"}</td></tr>`);
          }
        }
      } catch (e){
        rows.push(`<tr><td>${sideName}</td><td>Error</td><td>${(e && e.message) || e}</td></tr>`);
      }
      return rows.join("");
    }
    const asks = await side(XRBC, { currency:"XRP" }, "Ask");
    const bids = await side({ currency:"XRP" }, XRBC, "Bid");
    return `
      <div style="overflow:auto">
        <table class="table">
          <thead><tr><th>Side</th><th>Price (XRP/XRBC)</th><th>Amount</th></tr></thead>
          <tbody>${asks}${bids}</tbody>
        </table>
      </div>
    `;
  }

  async function refreshOrderBook(){
    if (!bookOut) return;
    info("Loading order book…");
    try {
      const html = await getOrderBookHtml();
      bookOut.innerHTML = html;
      ok("Order book updated.");
    } catch (e){
      bookOut.textContent = "Error loading order book: " + (e?.message || e);
      fail("Error loading order book");
    }
  }

  async function refreshLedger(){
    if (!ledgerOut) return;
    info("Fetching validated ledger…");
    try {
      const data = await xrplRequest({ method:"ledger", params:[{ ledger_index:"validated" }] });
      const r = data?.result || {};
      const idx  = r.ledger_index || r.validated_ledger_index || r.ledger?.ledger_index;
      const hash = r.ledger_hash  || r.ledger?.ledger_hash;
      const close = r.ledger?.close_time_human || r.closed?.close_time_human;
      const summary = {
        ledger_index: idx ?? "(unknown)",
        ledger_hash: hash ?? "(unknown)",
        close_time: close || "(not expanded)",
        validated: r.validated === undefined ? true : !!r.validated
      };
      ledgerOut.textContent = JSON.stringify(summary, null, 2);
      ok("Ledger updated.");
    } catch (e){
      ledgerOut.textContent = "Error fetching ledger: " + (e?.message || e);
      fail("Ledger error");
    }
  }

  async function refreshAmmMini(){
    if (!ammOut) return;
    try {
      const data = await xrplRequest({
        method:"amm_info",
        params:[{ asset:{ currency:"XRP" }, asset2:{ currency:XRBC.currency, issuer:XRBC.issuer } }]
      });
      const amm = data?.result?.amm;
      if (!amm){ ammOut.textContent = "No AMM pool exists yet."; return; }
      const reserveXrp  = (parseFloat(amm.amount) / XRP_TO_DROPS).toFixed(6);
      const reserveXrbc = parseFloat(amm.amount2.value).toFixed(6);
      const feeRate     = (amm.trading_fee / 10000).toFixed(2) + "%";
      ammOut.innerHTML = `
        <table class="table">
          <thead><tr><th>Reserve XRP</th><th>Reserve XRBC</th><th>Trading Fee</th></tr></thead>
          <tbody><tr><td>${reserveXrp}</td><td>${reserveXrbc}</td><td>${feeRate}</td></tr></tbody>
        </table>`;
    } catch (e){
      ammOut.textContent = "Error fetching AMM: " + (e?.message || e);
    }
  }

  async function refreshAll(){
    info("Refreshing metrics…");
    await Promise.allSettled([ refreshOrderBook(), refreshLedger(), refreshAmmMini() ]);
  }

  // Kick off + auto
  refreshAll().catch(()=>{});
  setInterval(() => { refreshAll().catch(()=>{}); }, 15000);
})();
  </script>

  <!-- ===== Footer ===== -->
  <footer class="site-footer" role="contentinfo" aria-label="XRBitcoinCash footer">
    <div class="wrap">
      <div class="cols" style="display:grid;gap:18px;grid-template-columns:1fr;max-width:var(--wrap-wide);margin:0 auto;">
        <section>
          <h3>About this page</h3>
          <p class="small">
            A minimal, security-first trading &amp; ledger portal for
            <strong>XRBitcoinCash (XRBC)</strong> on the <span class="nowrap">XRP Ledger</span>.
            Signing is handled in <strong>Xaman</strong> on mobile for safer review and execution.
          </p>
          <dl class="factlist" aria-label="XRBC details" style="display:grid;gap:6px;margin:0">
            <div class="fact" style="display:flex;gap:8px"><strong style="min-width:142px;color:#cfe6ff">Symbol</strong><span class="mono">XRBC</span></div>
            <div class="fact" style="display:flex;gap:8px"><strong style="min-width:142px;color:#cfe6ff">Issuer</strong><span class="mono">rEjwniYhYR5QDZzK1a1x2359j8j8N43Ypw</span></div>
            <div class="fact" style="display:flex;gap:8px"><strong style="min-width:142px;color:#cfe6ff">Currency Code</strong><span class="mono">5852626974636F696E6361736800000000000000</span></div>
            <div class="fact" style="display:flex;gap:8px"><strong style="min-width:142px;color:#cfe6ff">Total Supply</strong><span class="mono">21,000,000</span></div>
          </dl>
        </section>

        <section>
          <h3>Security measures</h3>
          <ul class="small" style="list-style:disc;margin-left:18px;display:grid;gap:6px">
            <li><strong>Mobile & desktop signing</strong> via Xaman; desktop shows a QR automatically in the Xaman flow.</li>
            <li>No keys ever requested or stored; only the public account address may be cached (localStorage).</li>
            <li>XRPL calls validated; errors handled; no <span class="mono">eval</span> or dynamic script injection.</li>
            <li>XRBC issuer &amp; currency code are constants; XRP↔drops conversion is precise.</li>
            <li>AMM helper estimates effective price incl. fee.</li>
          </ul>
        </section>

        <section style="display:grid;gap:10px;justify-items:center;">
          <h3>Whitepaper &amp; credits</h3>
          <a class="eco-link" href="/whitepaper.html" aria-label="Open the XRBitcoinCash Whitepaper" style="min-width:200px;">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor" d="M6 2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"></path>
              <path fill="#ffffff" d="M13 2v5h5"></path>
            </svg>
            Whitepaper
          </a>
          <a class="eco-link" href="https://chat.openai.com/" target="_blank" rel="noopener noreferrer" aria-label="Talk to ChatGPT" style="min-width:200px;">
            <img src="/assets/chatgpt-mark.svg" alt="" onerror="this.remove()">
            <span>Built with ChatGPT</span>
          </a>
          <p class="small" style="margin-top:4px;opacity:.9">
            Verify the URL starts with <span class="mono">https://xrbitcoincash.com</span>.
          </p>
        </section>
      </div>

      <div class="legal small" style="border-top:1px dashed #1f2a37;padding-top:10px;display:flex;flex-wrap:wrap;gap:6px;justify-content:space-between;align-items:center">
        <span>XRBC · XRBC/XRP Trading &amp; Ledger Portal</span>
        <span class="mono">Issuer: rEjwniYhYR5QDZzK1a1x2359j8j8N43Ypw</span>
      </div>
    </div>
  </footer>
</body>
</html>
