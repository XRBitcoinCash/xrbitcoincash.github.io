<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XRPL WS Debug</title>
</head>
<body>
<h2>XRPL WS Debug Test</h2>
<div id="status">Connecting…</div>

<script type="module">
import xrpl from 'https://cdn.jsdelivr.net/npm/xrpl@3.2.0/dist/xrpl.mjs';

const statusEl = document.getElementById('status');
let client = null;

async function testConnect() {
  const url = 'wss://s1.ripple.com';
  try {
    console.log('Creating client…');
    client = new xrpl.Client(url);

    client.on('error', (err) => console.error('WebSocket error:', err));
    client.on('disconnected', (code) => console.log('Disconnected with code', code));
    client.on('connected', () => console.log('WebSocket connected event fired'));

    console.log('Connecting…');
    await client.connect();
    console.log('Connection promise resolved');
    statusEl.textContent = 'Connected ✅';

    console.log('Sending server_info request…');
    const info = await client.request({ command: 'server_info' });
    console.log('Server info received:', info);

  } catch (e) {
    statusEl.textContent = 'Connection failed ❌';
    console.error('XRPL connect failed:', e);
  }
}

window.addEventListener('DOMContentLoaded', testConnect);
</script>
</body>
</html>
