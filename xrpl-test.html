<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XRBC Test DEX - Minimal Connection</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #xrpl-status { margin-bottom: 10px; font-weight: bold; }
    button { padding: 8px 16px; margin-right: 10px; }
  </style>
</head>
<body>

<h2>XRBC Test DEX - Minimal</h2>

<div id="xrpl-status">XRPL Node: Disconnected ❌</div>
<button id="connect-node">Connect to XRPL Node</button>
<button id="connect-wallet" disabled>Connect Wallet (Manual)</button>

<script type="module">
import xrpl from 'https://cdn.jsdelivr.net/npm/xrpl@3.2.0/dist/xrpl.mjs';

let xrplClient = null;
const statusEl = document.getElementById('xrpl-status');
const connectNodeBtn = document.getElementById('connect-node');
const connectWalletBtn = document.getElementById('connect-wallet');

// XRPL connection
async function connectXRPL() {
  const WSS_URL = 'wss://s1.ripple.com'; // public XRPL node
  statusEl.textContent = 'Connecting to XRPL Node…';
  try {
    xrplClient = new xrpl.Client(WSS_URL);
    await xrplClient.connect();
    statusEl.textContent = 'XRPL Node: Connected ✅';
    console.log('WebSocket opened successfully.');

    // Test server_info request
    const serverInfo = await xrplClient.request({ command: 'server_info' });
    console.log('Received server_info:', serverInfo);

    // Enable wallet button only after node connection
    connectWalletBtn.disabled = false;
  } catch (err) {
    statusEl.textContent = 'XRPL Node: Connection failed ❌';
    console.error('XRPL connection error:', err);
  }
}

// Manual wallet connection
async function connectWallet() {
  // Placeholder: insert your wallet connection logic here
  alert('Wallet connection would be initialized here manually.');
}

// Button events
connectNodeBtn.addEventListener('click', connectXRPL);
connectWalletBtn.addEventListener('click', connectWallet);
</script>

</body>
</html>
