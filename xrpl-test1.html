<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>XRBC · Obscura Harness (READ-ONLY)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Make it invisible to crawlers -->
  <meta name="robots" content="noindex,nofollow,noarchive,nosnippet" />
  <meta http-equiv="X-Robots-Tag" content="noindex, nofollow, noarchive, nosnippet" />
  <!-- Tight CSP: no externals, no inline eval -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline';
                 script-src 'self'; connect-src 'self'; object-src 'none'; base-uri 'none';
                 form-action 'none'; frame-ancestors 'none'; upgrade-insecure-requests;">
  <style>
    :root { color-scheme: dark; }
    body { margin:0; font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial;
           background:#0b0f14; color:#e6edf3; }
    .wrap { max-width:960px; margin:0 auto; padding:24px 14px 60px; }
    h1 { font-size:22px; margin:6px 0 10px; letter-spacing:.2px; }
    .chip { font-size:12px; padding:4px 8px; border:1px solid #2b3a4b; border-radius:999px; opacity:.9; }
    .warn { color:#ffb4a6; }
    .muted { opacity:.8; }
    .grid { display:grid; grid-template-columns:1fr; gap:14px; margin-top:16px; }
    .card { border:1px solid #1e2835; background:#0f1620; border-radius:14px; padding:14px; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    button { background:#223246; color:#e6edf3; border:1px solid #2c4157; border-radius:10px;
             padding:8px 12px; cursor:pointer; }
    button:disabled { opacity:.45; cursor:not-allowed; }
    pre { background:#0b111a; border:1px solid #1c2734; border-radius:10px; padding:10px; overflow:auto; }
    code.k { color:#8ab4ff; }
    .ok { color:#9ee493; }
    .err { color:#ff8a8a; }
    .shield { border:1px dashed #ff8a8a; padding:12px; border-radius:12px; background:#160e0e; }
    .divider { height:1px; background:#18222f; margin:10px 0; opacity:.7; }
    .foot { margin-top:16px; font-size:12px; opacity:.7; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content:space-between;">
      <h1>XRBC · Obscura Harness <span class="chip">READ-ONLY</span></h1>
      <span class="chip warn">Hidden / Non-discoverable</span>
    </div>
    <p class="muted">Private QA page for XRBitcoinCash. No wallet, no signing, no trading. Endpoint sanity checks only.</p>

    <div class="card shield">
      <strong>Safety interlock:</strong> This page intentionally <em>cannot</em> create Xaman/Xumm payloads, QR codes, or any on-ledger actions.
      It reads JSON from your public endpoints only. To prevent accidents, all action buttons are removed by design.
    </div>

    <div class="grid">
      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <h3 style="margin:0;">Ping</h3>
          <button id="btnPing">Run</button>
        </div>
        <div class="divider"></div>
        <pre id="outPing">—</pre>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <h3 style="margin:0;">Health</h3>
          <button id="btnHealth">Run</button>
        </div>
        <div class="divider"></div>
        <pre id="outHealth">—</pre>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <h3 style="margin:0;">Price snapshot</h3>
          <button id="btnPrice">Run</button>
        </div>
        <div class="divider"></div>
        <pre id="outPrice">—</pre>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <h3 style="margin:0;">Order book (top)</h3>
          <button id="btnBook">Run</button>
        </div>
        <div class="divider"></div>
        <pre id="outBook">—</pre>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <h3 style="margin:0;">Identity manifests</h3>
          <div class="row">
            <button id="btnToml">TOML</button>
            <button id="btnUA">universal-ai.json</button>
          </div>
        </div>
        <div class="divider"></div>
        <pre id="outId">—</pre>
      </div>
    </div>

    <p class="foot">
      Endpoints referenced: <code class="k">/ai/ai/ping.html</code>, <code class="k">/ai/ai/health.html</code>,
      <code class="k">/ai/ai/price.html</code>, <code class="k">/ai/ai/orderbook.html</code>,
      <code class="k">/.well-known/xrp-ledger.toml</code>, <code class="k">/universal-ai.json</code>.
    </p>
  </div>

  <script>
    // Read-only fetcher (no POSTs, no wallet libs)
    async function j(url) {
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) throw new Error(url + " → " + r.status);
      const ct = r.headers.get("content-type") || "";
      if (ct.includes("application/json") || url.endsWith(".html")) return r.json();
      return r.text();
    }

    function show(el, data) {
      el.textContent = (typeof data === "string")
        ? data
        : JSON.stringify(data, null, 2);
    }

    function ok(el) { el.previousElementSibling?.classList?.add("ok"); }
    function err(el) { el.previousElementSibling?.classList?.add("err"); }

    const $ = (id) => document.getElementById(id);

    $("btnPing").onclick = async () => {
      const out = $("outPing");
      out.textContent = "Checking /ai/ai/ping.html …";
      try { const d = await j("/ai/ai/ping.html"); show(out, d); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };

    $("btnHealth").onclick = async () => {
      const out = $("outHealth");
      out.textContent = "Checking /ai/ai/health.html …";
      try { const d = await j("/ai/ai/health.html"); show(out, d); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };

    $("btnPrice").onclick = async () => {
      const out = $("outPrice");
      out.textContent = "Checking /ai/ai/price.html …";
      try { const d = await j("/ai/ai/price.html"); show(out, d); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };

    $("btnBook").onclick = async () => {
      const out = $("outBook");
      out.textContent = "Checking /ai/ai/orderbook.html …";
      try { const d = await j("/ai/ai/orderbook.html"); show(out, d); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };

    $("btnToml").onclick = async () => {
      const out = $("outId");
      out.textContent = "Fetching /.well-known/xrp-ledger.toml …";
      try { const t = await fetch("/.well-known/xrp-ledger.toml", { cache:"no-store" }).then(r=>r.text());
            show(out, t.slice(0, 5000)); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };

    $("btnUA").onclick = async () => {
      const out = $("outId");
      out.textContent = "Fetching /universal-ai.json …";
      try { const d = await j("/universal-ai.json"); show(out, d); ok(out); } catch (e) { show(out, String(e)); err(out); }
    };
  </script>
</body>
</html>

